(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[801],{750:(e,t,r)=>{Promise.resolve().then(r.bind(r,6895))},6895:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>eC});var a=r(1659),s=r(9531),o=r(5303),n=r(2792);let l=e=>{e&&(e.setOption("inputStyle","contenteditable"),e.setOption("lineWrapping",!0),e.setOption("styleSelectedText",!1),e.setOption("electricChars",!1),e.setOption("smartIndent",!1),e.setOption("autofocus",!0),e.setOption("workTime",200),e.setOption("workDelay",300),e.setOption("pollInterval",100),n.V.info("MARKDOWN_UTILS","Korean IME optimization applied (cursor-safe version)"))},i=()=>({autofocus:!0,spellChecker:!1,placeholder:"이야기를 시작해보세요...",status:["lines","words","cursor"],toolbar:!1,shortcuts:{toggleBold:"Cmd-B",toggleItalic:"Cmd-I",drawLink:"Cmd-K",toggleHeading1:"Cmd-Alt-1",toggleHeading2:"Cmd-Alt-2",toggleHeading3:"Cmd-Alt-3",cleanBlock:"Cmd-E",drawImage:"Cmd-Alt-I",toggleUnorderedList:"Cmd-Shift-8",toggleOrderedList:"Cmd-Shift-7",toggleBlockquote:"Cmd-Shift-9",toggleCodeBlock:"Cmd-Alt-C",togglePreview:"Cmd-P",toggleSideBySide:"F9",toggleFullScreen:"F11",toggleDarkMode:"Cmd-D"},inputStyle:"contenteditable",nativeSpellcheck:!0,previewRender:e=>'<div class="prose dark:prose-invert max-w-none">'.concat(e,"</div>"),renderingConfig:{singleLineBreaks:!1,codeSyntaxHighlighting:!0},autoDownloadFontAwesome:!1,tabSize:2,lineWrapping:!0,styleSelectedText:!1,parsingConfig:{allowAtxHeaderWithoutSpace:!0},lineNumbers:!1,mode:{name:"markdown",highlightFormatting:!1},configureMouse:()=>({addNew:!1}),indentWithTabs:!1,smartIndent:!1,electricChars:!1,rtlMoveVisually:!0,extraKeys:{"Cmd-B":function(e){let t=e.getCursor(),r=e.getSelection();r?e.replaceSelection("**".concat(r,"**")):(e.replaceSelection("****"),e.setCursor({line:t.line,ch:t.ch+2}))},"Cmd-I":function(e){let t=e.getCursor(),r=e.getSelection();r?e.replaceSelection("*".concat(r,"*")):(e.replaceSelection("**"),e.setCursor({line:t.line,ch:t.ch+1}))},"Cmd-K":function(e){let t=e.getCursor(),r=e.getSelection();if(r){e.replaceSelection("[".concat(r,"]()"));let t=e.getCursor();e.setCursor({line:t.line,ch:t.ch-1})}else e.replaceSelection("[링크 텍스트]()"),e.setSelection({line:t.line,ch:t.ch+1},{line:t.line,ch:t.ch+6})},Space:function(e){let t=e.getCursor(),r=e.getLine(t.line).substring(0,t.ch);if(r.match(/^(#{1,6})$/)||r.match(/^([-*])$/)||r.match(/^(\d+\.)$/)||r.match(/^(>)$/))return void e.replaceSelection(" ");e.replaceSelection(" ")}}}),d=()=>({...i(),toolbar:!1,status:!1}),c=(0,s.createContext)(null);function u(e){let{children:t}=e,r=(0,s.useRef)(null),o=(0,s.useCallback)(e=>{if(e&&e.codemirror)try{n.V.debug("EDITOR","Initializing editor for Korean input optimization"),l(e.codemirror),r.current=e,n.V.info("EDITOR","Editor initialized with Korean input optimization")}catch(e){n.V.error("EDITOR","Failed to initialize editor",e)}},[]);return(0,a.jsx)(c.Provider,{value:{editorRef:r,initializeEditor:o,getEditorOptions:i,getFocusModeOptions:d},children:t})}var g=r(6083),x=r(8317);let h=/Mac|iPod|iPhone|iPad/.test(navigator.platform),b=[{key:"b",modifier:!0,action:e=>(e.chain().focus().toggleBold().run(),n.V.debug("EDITOR_SHORTCUTS","Bold toggled"),!0),description:"볼드 토글"},{key:"i",modifier:!0,action:e=>(e.chain().focus().toggleItalic().run(),n.V.debug("EDITOR_SHORTCUTS","Italic toggled"),!0),description:"이탤릭 토글"},{key:"u",modifier:!0,action:e=>(e.chain().focus().toggleUnderline().run(),n.V.debug("EDITOR_SHORTCUTS","Underline toggled"),!0),description:"언더라인 토글"},{key:"s",modifier:!0,shift:!0,action:e=>(e.chain().focus().toggleStrike().run(),n.V.debug("EDITOR_SHORTCUTS","Strikethrough toggled"),!0),description:"취소선 토글"},{key:"k",modifier:!0,action:e=>(n.V.debug("EDITOR_SHORTCUTS","Link shortcut triggered"),!0),description:"링크 생성"},{key:"1",modifier:!0,alt:!0,action:e=>(e.chain().focus().toggleHeading({level:1}).run(),n.V.debug("EDITOR_SHORTCUTS","H1 toggled"),!0),description:"제목 1"},{key:"2",modifier:!0,alt:!0,action:e=>(e.chain().focus().toggleHeading({level:2}).run(),n.V.debug("EDITOR_SHORTCUTS","H2 toggled"),!0),description:"제목 2"},{key:"3",modifier:!0,alt:!0,action:e=>(e.chain().focus().toggleHeading({level:3}).run(),n.V.debug("EDITOR_SHORTCUTS","H3 toggled"),!0),description:"제목 3"},{key:"0",modifier:!0,alt:!0,action:e=>(e.chain().focus().setParagraph().run(),n.V.debug("EDITOR_SHORTCUTS","Paragraph set"),!0),description:"일반 텍스트"},{key:"8",modifier:!0,shift:!0,action:e=>(e.chain().focus().toggleBulletList().run(),n.V.debug("EDITOR_SHORTCUTS","Bullet list toggled"),!0),description:"불릿 리스트"},{key:"7",modifier:!0,shift:!0,action:e=>(e.chain().focus().toggleOrderedList().run(),n.V.debug("EDITOR_SHORTCUTS","Ordered list toggled"),!0),description:"번호 리스트"},{key:"s",modifier:!0,action:e=>{let t=new CustomEvent("editor:save");return window.dispatchEvent(t),n.V.info("EDITOR_SHORTCUTS","Save triggered"),!0},description:"저장"}],m={trigger:"fixed bottom-4 right-4 z-50 w-12 h-12 bg-blue-600 hover:bg-blue-700 text-white rounded-full flex items-center justify-center shadow-lg transition-colors cursor-pointer",modal:"fixed inset-0 z-[100] flex items-center justify-center bg-black bg-opacity-50",panel:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl max-w-lg w-full mx-4 max-h-[80vh] overflow-hidden",header:"flex items-center justify-between p-6 border-b border-slate-200 dark:border-slate-700",title:"text-xl font-bold text-slate-900 dark:text-slate-100",closeButton:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",content:"p-6 overflow-y-auto",helpText:"prose prose-slate dark:prose-invert max-w-none text-sm"};function p(e){let{className:t=""}=e,[r,o]=(0,s.useState)(!1),n=()=>{o(!1)};return s.useEffect(()=>{let e=e=>{"Escape"===e.key&&r&&n()},t=()=>{o(e=>!e)};return document.addEventListener("keydown",e),window.addEventListener("shortcut:help",t),()=>{document.removeEventListener("keydown",e),window.removeEventListener("shortcut:help",t)}},[r]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{className:"".concat(m.trigger," ").concat(t),onClick:()=>{o(e=>!e)},title:"단축키 도움말 (F1)","aria-label":"단축키 도움말",children:(0,a.jsx)(g.A,{size:24})}),r&&(0,a.jsx)("div",{className:m.modal,onClick:e=>{e.target===e.currentTarget&&n()},children:(0,a.jsxs)("div",{className:m.panel,children:[(0,a.jsxs)("div",{className:m.header,children:[(0,a.jsx)("h2",{className:m.title,children:"키보드 단축키"}),(0,a.jsx)("button",{className:m.closeButton,onClick:n,"aria-label":"닫기",children:(0,a.jsx)(x.A,{size:20})})]}),(0,a.jsx)("div",{className:m.content,children:(0,a.jsxs)("div",{className:m.helpText,children:[(0,a.jsx)("div",{dangerouslySetInnerHTML:{__html:(function(){let e=h?"⌘":"Ctrl",t=h?"⌥":"Alt";return"\n\uD83D\uDCDD **텍스트 포맷팅**\n• ".concat(e,"+B: 볼드\n• ").concat(e,"+I: 이탤릭  \n• ").concat(e,"+U: 언더라인\n• ").concat(e,"+Shift+S: 취소선\n• ").concat(e,"+K: 링크\n\n\uD83D\uDCC4 **헤딩**\n• ").concat(e,"+").concat(t,"+1: 제목 1\n• ").concat(e,"+").concat(t,"+2: 제목 2\n• ").concat(e,"+").concat(t,"+3: 제목 3\n• ").concat(e,"+").concat(t,"+0: 일반 텍스트\n\n\uD83D\uDCCB **리스트**\n• ").concat(e,"+Shift+8: 불릿 리스트\n• ").concat(e,"+Shift+7: 번호 리스트\n\n\uD83D\uDCBE **저장**\n• ").concat(e,"+S: 저장\n").trim()})().replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")}}),(0,a.jsxs)("div",{className:"mt-6 pt-4 border-t border-slate-200 dark:border-slate-700",children:[(0,a.jsx)("h3",{className:"font-bold text-slate-900 dark:text-slate-100 mb-2",children:"\uD83D\uDCD6 마크다운 단축키"}),(0,a.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("code",{className:"bg-slate-100 dark:bg-slate-700 px-2 py-1 rounded",children:"# 스페이스"})," → 제목 1"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("code",{className:"bg-slate-100 dark:bg-slate-700 px-2 py-1 rounded",children:"## 스페이스"})," → 제목 2"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("code",{className:"bg-slate-100 dark:bg-slate-700 px-2 py-1 rounded",children:"### 스페이스"})," → 제목 3"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("code",{className:"bg-slate-100 dark:bg-slate-700 px-2 py-1 rounded",children:"- 스페이스"})," → 불릿 리스트"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("code",{className:"bg-slate-100 dark:bg-slate-700 px-2 py-1 rounded",children:"1. 스페이스"})," → 번호 리스트"]})]})]}),(0,a.jsx)("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[(0,a.jsx)("strong",{children:"\uD83D\uDCA1 팁:"})," 텍스트를 선택하고 단축키를 누르면 선택된 텍스트에 포맷이 적용됩니다."]})})]})})]})})]})}var f=r(2381),y=r(4102),v=r(5009),j=r(7955),k=r(8325),w=r(3869),T=r(7993);let C={container:"flex flex-col bg-gray-50 dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 transition-all duration-300 h-full",collapsed:"w-12",expanded:"w-64",scrollArea:"flex-1 overflow-y-auto overflow-x-hidden custom-scrollbar",menuSection:"p-3 space-y-1",menuItem:"flex items-center gap-3 px-3 py-2 text-sm font-medium transition-colors duration-200 cursor-pointer rounded-md",menuItemActive:"bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300",menuItemInactive:"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",sectionHeader:"text-xs font-semibold text-gray-500 dark:text-gray-400 mb-2 px-3",structureList:"space-y-1 px-3",structureItem:"flex items-center gap-2 py-1.5 text-sm text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 cursor-pointer transition-colors",statsSection:"p-3 border-t border-gray-200 dark:border-gray-700",statItem:"flex justify-between items-center py-1 text-sm",statLabel:"text-gray-600 dark:text-gray-400",statValue:"font-medium text-gray-900 dark:text-gray-100"},A=[{id:"write",label:"글쓰기",icon:v.A},{id:"structure",label:"구조",icon:j.A},{id:"characters",label:"인물",icon:T.A},{id:"notes",label:"메모",icon:f.A}];function N(e){let{currentView:t,onViewChange:r,structure:o,characters:n,stats:l,collapsed:i}=e,[d,c]=(0,s.useState)(new Set(["structure"]));return i?(0,a.jsx)("div",{className:"".concat(C.container," ").concat(C.collapsed),children:(0,a.jsx)("div",{className:C.menuSection,children:A.map(e=>(0,a.jsx)("button",{onClick:()=>r(e.id),className:"w-8 h-8 flex items-center justify-center rounded-md transition-colors ".concat(t===e.id?"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-300":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"),title:e.label,children:(0,a.jsx)(e.icon,{size:16})},e.id))})}):(0,a.jsxs)("div",{className:"".concat(C.container," ").concat(C.expanded),children:[(0,a.jsx)("div",{className:C.menuSection,children:A.map(e=>(0,a.jsxs)("button",{onClick:()=>r(e.id),className:"".concat(C.menuItem," ").concat(t===e.id?C.menuItemActive:C.menuItemInactive),children:[(0,a.jsx)(e.icon,{size:16}),(0,a.jsx)("span",{children:e.label})]},e.id))}),(0,a.jsxs)("div",{className:C.scrollArea,children:["write"===t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"p-3",children:[(0,a.jsx)("h3",{className:C.sectionHeader,children:"프로젝트 구조"}),(0,a.jsx)("div",{className:C.structureList,children:o.map((e,t)=>(0,a.jsxs)("div",{className:C.structureItem,children:[(0,a.jsx)(y.A,{size:12,className:"text-blue-500"}),(0,a.jsx)("span",{className:"flex-1",children:"".concat(t+1,"장: ").concat(e.title)}),(0,a.jsx)("span",{className:"text-xs text-gray-400",children:e.status})]},e.id))})]}),(0,a.jsxs)("div",{className:C.statsSection,children:[(0,a.jsx)("h3",{className:C.sectionHeader,children:"글쓰기 통계"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:C.statItem,children:[(0,a.jsx)("span",{className:C.statLabel,children:"단어"}),(0,a.jsx)("span",{className:C.statValue,children:l.wordCount})]}),(0,a.jsxs)("div",{className:C.statItem,children:[(0,a.jsx)("span",{className:C.statLabel,children:"문자"}),(0,a.jsx)("span",{className:C.statValue,children:l.charCount})]}),(0,a.jsxs)("div",{className:C.statItem,children:[(0,a.jsx)("span",{className:C.statLabel,children:"진행률"}),(0,a.jsxs)("span",{className:C.statValue,children:[l.progress,"%"]})]})]})]})]}),"structure"===t&&(0,a.jsxs)("div",{className:"p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:C.sectionHeader,children:"구조 관리"}),(0,a.jsx)("button",{className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300",children:(0,a.jsx)(w.A,{size:16})})]}),(0,a.jsxs)("div",{className:C.structureList,children:[o.map((e,t)=>(0,a.jsxs)("div",{className:"".concat(C.structureItem," justify-between"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{size:12,className:"text-blue-500"}),(0,a.jsx)("span",{className:"flex-1",children:"".concat(t+1,"장: ").concat(e.title)})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{className:"text-xs text-gray-400",children:e.status}),(0,a.jsx)("button",{className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,a.jsx)(k.A,{size:12})})]})]},e.id)),0===o.length&&(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,a.jsx)(j.A,{size:32,className:"mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{className:"text-sm",children:"구조를 추가해보세요"})]})]})]}),"characters"===t&&(0,a.jsxs)("div",{className:"p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:C.sectionHeader,children:"인물 관리"}),(0,a.jsx)("button",{className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300",children:(0,a.jsx)(w.A,{size:16})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[n.map(e=>(0,a.jsxs)("div",{className:"".concat(C.structureItem," justify-between"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-purple-400 to-pink-400 flex items-center justify-center text-white text-xs font-medium",children:e.name.charAt(0)}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-medium text-sm",children:e.name}),e.role&&(0,a.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.role})]})]}),(0,a.jsx)("button",{className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,a.jsx)(k.A,{size:12})})]},e.id)),0===n.length&&(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,a.jsx)(T.A,{size:32,className:"mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{className:"text-sm",children:"인물을 추가해보세요"})]})]})]}),"notes"===t&&(0,a.jsxs)("div",{className:"p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:C.sectionHeader,children:"메모 관리"}),(0,a.jsx)("button",{className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300",children:(0,a.jsx)(w.A,{size:16})})]}),(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[(0,a.jsx)(f.A,{size:32,className:"mx-auto mb-2 opacity-50"}),(0,a.jsx)("p",{className:"text-sm",children:"메모를 추가해보세요"})]})})]})]})]})}var E=r(2972),D=r(5922),I=r(7294),S=r(6186),R=r(3914),O=r(541),V=r(7),_=r(3818),P=r(2394),B=r(2049),H=r(5205),F=r(2163),L=r(3610);let J={header:"flex items-center justify-between px-4 py-3 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700 transition-colors duration-200",headerLeft:"flex items-center gap-3",headerCenter:"flex-1 max-w-md mx-auto",headerRight:"flex items-center gap-2 relative",backButton:"flex items-center gap-2 px-3 py-1.5 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-md transition-colors",titleInput:"border-none bg-transparent focus:outline-none focus:ring-0 text-lg font-medium w-full placeholder:text-gray-400 dark:placeholder:text-gray-500 text-gray-900 dark:text-gray-100",iconButton:"flex items-center justify-center w-9 h-9 rounded-lg transition-colors hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-600 dark:text-gray-400 relative group",iconButtonActive:"flex items-center justify-center w-9 h-9 rounded-lg bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 relative group",tooltip:"absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 px-2 py-1 bg-gray-900 dark:bg-gray-700 text-white text-xs rounded whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-50",tooltipWithShortcut:"absolute bottom-full mb-2 left-1/2 transform -translate-x-1/2 px-3 py-2 bg-gray-900 dark:bg-gray-700 text-white text-xs rounded whitespace-nowrap opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none z-50",shortcut:"block text-gray-400 text-xs mt-1",slidebar:"fixed top-0 right-0 h-full w-80 bg-white dark:bg-gray-900 border-l border-gray-200 dark:border-gray-700 shadow-xl transform transition-transform duration-300 ease-in-out z-40",slidebarOpen:"translate-x-0",slidebarClosed:"translate-x-full",slidebarHeader:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",slidebarTitle:"text-lg font-semibold text-gray-900 dark:text-gray-100",slidebarContent:"p-4 overflow-y-auto h-full",slidebarOverlay:"fixed inset-0 bg-black/50 z-30"};function M(e){let{title:t,onTitleChange:r,onBack:o,sidebarCollapsed:l,onToggleSidebar:i,isFocusMode:d,onToggleFocusMode:c,onSave:u,onShare:g,onDownload:x,onDelete:h}=e,[b,m]=(0,s.useState)(null),[p,f]=(0,s.useState)(document.documentElement.classList.contains("dark")),y=e=>{m(b===e?null:e)},v=async()=>{try{await navigator.clipboard.writeText(t),n.V.info("PROJECT_HEADER","Project title copied to clipboard")}catch(e){n.V.error("PROJECT_HEADER","Failed to copy to clipboard",e)}},j=[{icon:P.A,label:"저장",shortcut:"Cmd+S",onClick:u},{icon:D.A,label:"복사",shortcut:"Cmd+C",onClick:v},{icon:B.A,label:"공유",shortcut:"Cmd+Shift+S",onClick:g},{icon:R.A,label:"내보내기",shortcut:"Cmd+E",onClick:x},{icon:L.A,label:"삭제",shortcut:"Cmd+Del",onClick:h}],k=[{icon:V.A,label:"AI 채팅",onClick:()=>y("ai")},{icon:p?F.A:_.A,label:p?"라이트 모드로 변경":"다크 모드로 변경",onClick:()=>{let e=!p;f(e),e?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light")),n.V.info("PROJECT_HEADER","Theme changed to ".concat(e?"dark":"light"))}},{icon:O.A,label:"에디터 전용모드",onClick:()=>{document.body.classList.contains("editor-only-mode")?(document.body.classList.remove("editor-only-mode"),n.V.info("PROJECT_HEADER","Editor-only mode disabled")):(document.body.classList.add("editor-only-mode"),n.V.info("PROJECT_HEADER","Editor-only mode enabled"))}}];return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:J.header,children:[(0,a.jsx)("div",{className:J.headerLeft,children:(0,a.jsxs)("button",{className:J.backButton,onClick:o,children:[(0,a.jsx)(E.A,{size:16}),(0,a.jsx)("span",{children:"프로젝트 목록"})]})}),(0,a.jsx)("div",{className:J.headerCenter,children:(0,a.jsx)("input",{type:"text",value:t,onChange:e=>r(e.target.value),placeholder:"프로젝트 제목을 입력하세요",className:J.titleInput})}),(0,a.jsxs)("div",{className:J.headerRight,children:[j.map((e,t)=>(0,a.jsxs)("button",{className:J.iconButton,onClick:e.onClick,children:[(0,a.jsx)(e.icon,{size:16}),(0,a.jsxs)("div",{className:J.tooltipWithShortcut,children:[(0,a.jsx)("div",{children:e.label}),e.shortcut&&(0,a.jsx)("div",{className:J.shortcut,children:e.shortcut})]})]},"action-".concat(t))),(0,a.jsx)("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-1"}),k.map((e,t)=>(0,a.jsxs)("button",{className:J.iconButton,onClick:e.onClick,children:[(0,a.jsx)(e.icon,{size:16}),(0,a.jsx)("div",{className:J.tooltip,children:e.label})]},"toolbar-".concat(t))),(0,a.jsx)("div",{className:"w-px h-6 bg-gray-300 dark:bg-gray-600 mx-1"}),(0,a.jsxs)("button",{className:l?J.iconButton:J.iconButtonActive,onClick:i,children:[(0,a.jsx)(H.A,{size:16}),(0,a.jsx)("div",{className:J.tooltip,children:"사이드바 토글"})]}),(0,a.jsxs)("button",{className:d?J.iconButtonActive:J.iconButton,onClick:c,children:[d?(0,a.jsx)(S.A,{size:16}):(0,a.jsx)(I.A,{size:16}),(0,a.jsx)("div",{className:J.tooltip,children:d?"포커스 모드 해제":"포커스 모드"})]})]})]}),b&&(0,a.jsx)("div",{className:J.slidebarOverlay,onClick:()=>m(null)}),(0,a.jsxs)("div",{className:"".concat(J.slidebar," ").concat("ai"===b?J.slidebarOpen:J.slidebarClosed),children:[(0,a.jsxs)("div",{className:J.slidebarHeader,children:[(0,a.jsx)("h3",{className:J.slidebarTitle,children:"AI 어시스턴트"}),(0,a.jsx)("button",{className:J.iconButton,onClick:()=>m(null),children:"✕"})]}),(0,a.jsx)("div",{className:J.slidebarContent,children:(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsx)("div",{className:"flex-1 overflow-y-auto mb-4 space-y-3",children:(0,a.jsx)("div",{className:"bg-blue-50 dark:bg-blue-950/20 p-3 rounded-lg",children:(0,a.jsx)("p",{className:"text-sm text-blue-900 dark:text-blue-100",children:"안녕하세요! 글쓰기를 도와드릴 AI 어시스턴트입니다. 어떻게 도와드릴까요?"})})}),(0,a.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,a.jsxs)("button",{className:"w-full p-3 text-left border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",onClick:async()=>{try{let e=await window.electronAPI.ai.improveText("선택된 텍스트 샘플");n.V.info("PROJECT_HEADER","Text improvement result",e)}catch(e){n.V.error("PROJECT_HEADER","Text improvement failed",e)}},children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"✨ 문장 개선"}),(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"선택한 텍스트를 더 자연스럽게 개선합니다"})]}),(0,a.jsxs)("button",{className:"w-full p-3 text-left border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",onClick:async()=>{try{let e=await window.electronAPI.ai.analyzeText("캐릭터 분석을 위한 텍스트");n.V.info("PROJECT_HEADER","Character analysis result",e)}catch(e){n.V.error("PROJECT_HEADER","Character analysis failed",e)}},children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"\uD83C\uDFAD 등장인물 분석"}),(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"캐릭터의 일관성을 검토합니다"})]}),(0,a.jsxs)("button",{className:"w-full p-3 text-left border border-gray-200 dark:border-gray-700 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",onClick:async()=>{try{let e=await window.electronAPI.ai.getWritingHelp("플롯 구성에 대한 조언을 주세요");n.V.info("PROJECT_HEADER","Plot analysis result",e)}catch(e){n.V.error("PROJECT_HEADER","Plot analysis failed",e)}},children:[(0,a.jsx)("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"\uD83D\uDCD6 플롯 체크"}),(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"스토리 흐름을 분석합니다"})]})]}),(0,a.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",placeholder:"AI에게 질문하거나 도움을 요청하세요...",className:"flex-1 px-3 py-2 border border-gray-200 dark:border-gray-700 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"전송"})]})})]})})]})]})}var z=r(5366);let U={overlay:"fixed inset-0 z-[100] flex items-center justify-center bg-black bg-opacity-50",dialog:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl max-w-md w-full mx-4 overflow-hidden",header:"flex items-center gap-3 p-6 border-b border-slate-200 dark:border-slate-700",icon:"w-8 h-8 text-red-500 flex-shrink-0",headerText:"flex-1",title:"text-lg font-bold text-slate-900 dark:text-slate-100",message:"text-sm text-slate-600 dark:text-slate-400 mt-1",closeButton:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",content:"p-6",description:"text-slate-700 dark:text-slate-300 leading-relaxed mb-4",projectName:"font-semibold text-slate-900 dark:text-slate-100",warning:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3 text-sm text-red-800 dark:text-red-200",footer:"flex items-center justify-end gap-3 p-6 border-t border-slate-200 dark:border-slate-700",cancelButton:"px-4 py-2 text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition-colors",deleteButton:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors font-medium"};function W(e){let{isOpen:t,projectTitle:r,onConfirm:s,onCancel:o}=e;return t?(0,a.jsx)("div",{className:U.overlay,onClick:e=>{e.target===e.currentTarget&&o()},onKeyDown:e=>{"Escape"===e.key&&o()},tabIndex:-1,children:(0,a.jsxs)("div",{className:U.dialog,children:[(0,a.jsxs)("div",{className:U.header,children:[(0,a.jsx)(z.A,{className:U.icon}),(0,a.jsxs)("div",{className:U.headerText,children:[(0,a.jsx)("h3",{className:U.title,children:"프로젝트 삭제"}),(0,a.jsx)("p",{className:U.message,children:"이 작업은 되돌릴 수 없습니다"})]}),(0,a.jsx)("button",{className:U.closeButton,onClick:o,"aria-label":"닫기",children:(0,a.jsx)(x.A,{size:20})})]}),(0,a.jsxs)("div",{className:U.content,children:[(0,a.jsxs)("p",{className:U.description,children:[(0,a.jsxs)("span",{className:U.projectName,children:["“",r,"”"]})," 프로젝트를 완전히 삭제하시겠습니까?"]}),(0,a.jsxs)("div",{className:U.warning,children:["⚠️ ",(0,a.jsx)("strong",{children:"주의:"})," 삭제된 프로젝트와 모든 데이터(캐릭터, 구조, 메모 등)는 복구할 수 없습니다."]})]}),(0,a.jsxs)("div",{className:U.footer,children:[(0,a.jsx)("button",{className:U.cancelButton,onClick:o,children:"취소"}),(0,a.jsx)("button",{className:U.deleteButton,onClick:s,autoFocus:!0,children:"삭제하기"})]})]})}):null}var G=r(1297),K=r(7897),$=r(3972);let q={overlay:"fixed inset-0 z-[100] flex items-center justify-center bg-black bg-opacity-50",dialog:"bg-white dark:bg-slate-800 rounded-xl shadow-2xl max-w-lg w-full mx-4 overflow-hidden",header:"flex items-center gap-3 p-6 border-b border-slate-200 dark:border-slate-700",icon:"w-8 h-8 text-blue-500 flex-shrink-0",headerText:"flex-1",title:"text-lg font-bold text-slate-900 dark:text-slate-100",subtitle:"text-sm text-slate-600 dark:text-slate-400 mt-1",closeButton:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",content:"p-6 space-y-4",section:"space-y-3",sectionTitle:"text-sm font-medium text-slate-900 dark:text-slate-100",optionGrid:"grid grid-cols-2 gap-3",option:"flex items-center gap-3 p-4 border border-slate-200 dark:border-slate-700 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors cursor-pointer",optionIcon:"w-5 h-5 text-slate-600 dark:text-slate-400",optionText:"text-sm text-slate-700 dark:text-slate-300",urlContainer:"flex items-center gap-2",urlInput:"flex-1 px-3 py-2 bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-900 dark:text-slate-100 font-mono",copyButton:"px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors text-sm font-medium flex items-center gap-2",copiedButton:"px-3 py-2 bg-green-600 text-white rounded-lg text-sm font-medium flex items-center gap-2",footer:"p-6 border-t border-slate-200 dark:border-slate-700 text-xs text-slate-500 dark:text-slate-400"};function Q(e){let{isOpen:t,projectTitle:r,projectId:o,onClose:l}=e,[i,d]=(0,s.useState)(!1),c="https://loop-writer.app/shared/".concat(o),u=(0,s.useCallback)(async()=>{try{await navigator.clipboard.writeText(c),d(!0),n.V.info("SHARE_DIALOG","URL copied to clipboard"),setTimeout(()=>d(!1),3e3)}catch(e){n.V.error("SHARE_DIALOG","Failed to copy URL",e)}},[c]),g=(0,s.useCallback)(()=>{n.V.info("SHARE_DIALOG","Export as text requested")},[]);(0,s.useCallback)(()=>{n.V.info("SHARE_DIALOG","Export as PDF requested")},[]);let h=(0,s.useCallback)(()=>{let e=encodeURIComponent("Loop 프로젝트: ".concat(r)),t=encodeURIComponent('안녕하세요,\n\n"'.concat(r,'" 프로젝트를 공유합니다.\n\n').concat(c,"\n\nLoop Writer에서 확인해보세요!")),a="mailto:?subject=".concat(e,"&body=").concat(t);window.open(a,"_blank"),n.V.info("SHARE_DIALOG","Email sharing opened")},[r,c]);return t?(0,a.jsx)("div",{className:q.overlay,onClick:e=>{e.target===e.currentTarget&&l()},onKeyDown:e=>{"Escape"===e.key&&l()},tabIndex:-1,children:(0,a.jsxs)("div",{className:q.dialog,children:[(0,a.jsxs)("div",{className:q.header,children:[(0,a.jsx)(B.A,{className:q.icon}),(0,a.jsxs)("div",{className:q.headerText,children:[(0,a.jsx)("h3",{className:q.title,children:"프로젝트 공유"}),(0,a.jsxs)("p",{className:q.subtitle,children:["“",r,"” 작품 공유하기"]})]}),(0,a.jsx)("button",{className:q.closeButton,onClick:l,"aria-label":"닫기",children:(0,a.jsx)(x.A,{size:20})})]}),(0,a.jsxs)("div",{className:q.content,children:[(0,a.jsxs)("div",{className:q.section,children:[(0,a.jsx)("h4",{className:q.sectionTitle,children:"링크로 공유"}),(0,a.jsxs)("div",{className:q.urlContainer,children:[(0,a.jsx)("input",{type:"text",value:c,readOnly:!0,className:q.urlInput}),(0,a.jsx)("button",{className:i?q.copiedButton:q.copyButton,onClick:u,disabled:i,children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(G.A,{size:16}),"복사됨"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(D.A,{size:16}),"복사"]})})]})]}),(0,a.jsxs)("div",{className:q.section,children:[(0,a.jsx)("h4",{className:q.sectionTitle,children:"공유 방법"}),(0,a.jsxs)("div",{className:q.optionGrid,children:[(0,a.jsxs)("button",{className:q.option,onClick:h,children:[(0,a.jsx)($.A,{className:q.optionIcon}),(0,a.jsx)("span",{className:q.optionText,children:"이메일"})]}),(0,a.jsxs)("button",{className:q.option,onClick:g,children:[(0,a.jsx)(K.A,{className:q.optionIcon}),(0,a.jsx)("span",{className:q.optionText,children:"텍스트 파일"})]})]})]})]}),(0,a.jsx)("div",{className:q.footer,children:"\uD83D\uDCA1 공유된 프로젝트는 읽기 전용으로 제공됩니다. 원본 편집은 작성자만 가능합니다."})]})}):null}var Z=r(1465),X=r(7052),Y=r(7386),ee=r(1218),et=r(9203),er=r(6476),ea=r(8723);let es={container:"w-full h-full flex flex-col",editor:"flex-1 p-6 prose prose-slate max-w-none focus:outline-none",focused:"prose-lg",bubble:"flex gap-2 p-2 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg shadow-lg",bubbleButton:"px-3 py-1 text-sm bg-slate-100 hover:bg-slate-200 dark:bg-slate-700 dark:hover:bg-slate-600 rounded transition-colors"};function eo(e){let{content:t,onChange:r,isFocusMode:o}=e,[l,i]=(0,s.useState)(!1),d=(0,Z.hG)({extensions:[X.A.configure({heading:{levels:[1,2,3,4]},bulletList:{HTMLAttributes:{class:"list-disc list-outside ml-6"}},orderedList:{HTMLAttributes:{class:"list-decimal list-outside ml-6"}}}),ea.A,Y.A.configure({placeholder:e=>{let{node:t}=e;if("heading"===t.type.name)switch(t.attrs.level){case 1:return"제목을 입력하세요...";case 2:return"챕터 제목...";case 3:return"섹션 제목...";default:return"소제목..."}return"이야기를 시작해보세요..."},showOnlyWhenEditable:!0,showOnlyCurrent:!1}),ee.A.configure({className:"has-focus",mode:"all"}),et.Ay.configure({openDoubleQuote:'"',closeDoubleQuote:'"',openSingleQuote:"'",closeSingleQuote:"'",ellipsis:"...",emDash:"--"}),er.A],content:t,editorProps:{attributes:{class:"".concat(es.editor," ").concat(o?es.focused:""),"data-placeholder":"이야기를 시작해보세요..."},handleKeyDown:(e,t)=>{let{state:r,dispatch:a}=e,{selection:s}=r;if(" "===t.key){let{$from:e}=s,o=e.parent.textContent.slice(0,e.parentOffset);if("#"===o){t.preventDefault(),t.stopPropagation();let s=r.schema.nodes.heading;if(!s)return n.V.warn("TIPTAP_EDITOR","Heading node type not found"),!1;let o=r.tr.setBlockType(e.before(),e.after(),s,{level:1});return o.delete(e.pos-1,e.pos),a(o),n.V.debug("TIPTAP_EDITOR","✅ Markdown: H1 applied"),!0}if("##"===o){t.preventDefault(),t.stopPropagation();let s=r.schema.nodes.heading;if(!s)return n.V.warn("TIPTAP_EDITOR","Heading node type not found"),!1;let o=r.tr.setBlockType(e.before(),e.after(),s,{level:2});return o.delete(e.pos-2,e.pos),a(o),n.V.debug("TIPTAP_EDITOR","✅ Markdown: H2 applied"),!0}if("###"===o){t.preventDefault(),t.stopPropagation();let s=r.schema.nodes.heading;if(!s)return n.V.warn("TIPTAP_EDITOR","Heading node type not found"),!1;let o=r.tr.setBlockType(e.before(),e.after(),s,{level:3});return o.delete(e.pos-3,e.pos),a(o),n.V.debug("TIPTAP_EDITOR","✅ Markdown: H3 applied"),!0}if("-"===o){t.preventDefault(),t.stopPropagation();let s=r.schema.nodes.listItem,o=r.schema.nodes.bulletList;if(!s||!o)return n.V.warn("TIPTAP_EDITOR","List node types not found"),!1;let l=r.tr.setBlockType(e.before(),e.after(),s);l.delete(e.pos-1,e.pos);let i=e.blockRange();return a(i&&l.wrap(i,[{type:o}])||l),n.V.debug("TIPTAP_EDITOR","✅ Markdown: Bullet list applied"),!0}if(/^\d+\.$/.test(o)){t.preventDefault(),t.stopPropagation();let s=r.schema.nodes.listItem,l=r.schema.nodes.orderedList;if(!s||!l)return n.V.warn("TIPTAP_EDITOR","List node types not found"),!1;let i=r.tr.setBlockType(e.before(),e.after(),s);i.delete(e.pos-o.length,e.pos);let d=e.blockRange();return a(d&&i.wrap(d,[{type:l}])||i),n.V.debug("TIPTAP_EDITOR","✅ Markdown: Ordered list applied"),!0}}return!!((t.ctrlKey||t.metaKey||t.altKey||["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12"].includes(t.key))&&function(e,t){if(!e)return!1;let{key:r,ctrlKey:a,metaKey:s,shiftKey:o,altKey:l}=t,i=h?s:a;if(" "===r||!i&&!o&&!l&&1===r.length)return!1;for(let a of b)if(a.key.toLowerCase()===r.toLowerCase()&&!!a.modifier===i&&!!a.shift===o&&!!a.alt===l){t.preventDefault(),t.stopPropagation();try{if(a.action(e))return n.V.debug("EDITOR_SHORTCUTS","Shortcut executed: ".concat(a.description),{key:a.key,modifier:i,shift:o,alt:l}),!0}catch(e){n.V.error("EDITOR_SHORTCUTS","Shortcut execution failed: ".concat(a.description),e)}}return!1}(d,t))}},onUpdate:e=>{var t;let{editor:a}=e;r(a.getHTML()),n.V.debug("TIPTAP_EDITOR","Content updated",{wordCount:(null==(t=a.storage.characterCount)?void 0:t.words())||0})},onCreate:e=>{let{editor:t}=e;i(!0),n.V.info("TIPTAP_EDITOR","Editor created successfully")},onFocus:e=>{let{editor:t}=e;n.V.debug("TIPTAP_EDITOR","Editor focused")},onBlur:e=>{let{editor:t}=e;n.V.debug("TIPTAP_EDITOR","Editor blurred")}});return((0,s.useEffect)(()=>{d&&t!==d.getHTML()&&d.commands.setContent(t,!1)},[t,d]),(0,s.useEffect)(()=>{d&&(d.view.dom.className="".concat(es.editor," ").concat(o?es.focused:""))},[o,d]),(0,s.useEffect)(()=>{if(!d)return;let e=d?(n.V.info("EDITOR_SHORTCUTS","Shortcuts system initialized",{shortcutCount:b.length,platform:h?"macOS":"Windows/Linux"}),()=>{n.V.debug("EDITOR_SHORTCUTS","Shortcuts system cleaned up")}):()=>{},t=()=>{let e=new CustomEvent("project:save");window.dispatchEvent(e),n.V.info("TIPTAP_EDITOR","Save event triggered from editor")};return window.addEventListener("editor:save",t),n.V.info("TIPTAP_EDITOR","Shortcuts and save event bound",{shortcutCount:b.length}),()=>{e(),window.removeEventListener("editor:save",t),n.V.debug("TIPTAP_EDITOR","Shortcuts and events unbound")}},[d]),(0,s.useEffect)(()=>()=>{d&&(d.destroy(),n.V.debug("TIPTAP_EDITOR","Editor destroyed"))},[d]),l)?(0,a.jsxs)("div",{className:es.container,children:[d&&(0,a.jsxs)(Z.mM,{editor:d,className:es.bubble,children:[(0,a.jsx)("button",{onClick:()=>d.chain().focus().toggleBold().run(),className:"".concat(es.bubbleButton," ").concat(d.isActive("bold")?"bg-blue-200 dark:bg-blue-800":""),title:"볼드 (Ctrl+B)",children:(0,a.jsx)("strong",{children:"B"})}),(0,a.jsx)("button",{onClick:()=>d.chain().focus().toggleItalic().run(),className:"".concat(es.bubbleButton," ").concat(d.isActive("italic")?"bg-blue-200 dark:bg-blue-800":""),title:"이탤릭 (Ctrl+I)",children:(0,a.jsx)("em",{children:"I"})}),(0,a.jsx)("button",{onClick:()=>d.chain().focus().toggleUnderline().run(),className:"".concat(es.bubbleButton," ").concat(d.isActive("underline")?"bg-blue-200 dark:bg-blue-800":""),title:"언더라인 (Ctrl+U)",children:(0,a.jsx)("u",{children:"U"})}),(0,a.jsx)("button",{onClick:()=>d.chain().focus().toggleStrike().run(),className:"".concat(es.bubbleButton," ").concat(d.isActive("strike")?"bg-blue-200 dark:bg-blue-800":""),title:"취소선 (Ctrl+Shift+S)",children:(0,a.jsx)("s",{children:"S"})}),(0,a.jsx)("button",{onClick:()=>d.chain().focus().toggleCode().run(),className:"".concat(es.bubbleButton," ").concat(d.isActive("code")?"bg-blue-200 dark:bg-blue-800":""),title:"코드",children:"Code"})]}),(0,a.jsx)(Z.$Z,{editor:d})]}):(0,a.jsx)("div",{className:es.container,children:(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)("div",{className:"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),(0,a.jsx)("span",{className:"text-slate-500 text-sm",children:"에디터 준비 중..."})]})})})}let en={container:"flex-1 flex flex-col h-full bg-white dark:bg-gray-900",editorWrapper:"flex-1 min-h-0 overflow-hidden"};function el(e){let{content:t,onChange:r,isFocusMode:s}=e;return(0,a.jsx)("div",{className:en.container,children:(0,a.jsx)("div",{className:en.editorWrapper,children:(0,a.jsx)(eo,{content:t,onChange:r,isFocusMode:s})})})}var ei=r(9161),ed=r(7357);let ec={container:"flex-1 overflow-hidden bg-white dark:bg-gray-900",header:"p-6 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",title:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2",subtitle:"text-gray-600 dark:text-gray-400",content:"flex-1 overflow-y-auto p-6",structureList:"space-y-2",structureItem:"flex items-center gap-3 p-3 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg hover:shadow-sm hover:border-gray-300 dark:hover:border-gray-600 transition-all duration-200 cursor-pointer",itemIcon:"w-5 h-5 text-blue-600 dark:text-blue-400",itemContent:"flex-1",itemTitle:"font-medium text-gray-900 dark:text-gray-100",itemType:"text-xs text-gray-500 dark:text-gray-400",addButton:"flex items-center gap-2 w-full p-3 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg text-gray-600 dark:text-gray-400 hover:border-blue-400 hover:text-blue-600 transition-colors"},eu={chapter:ed.A,scene:j.A,note:ei.A};function eg(e){let{structure:t,onStructureChange:r}=e;return(0,a.jsxs)("div",{className:ec.container,children:[(0,a.jsxs)("div",{className:ec.header,children:[(0,a.jsx)("h2",{className:ec.title,children:"스토리 구조"}),(0,a.jsx)("p",{className:ec.subtitle,children:"장, 장면, 메모를 관리하여 이야기의 흐름을 구성하세요"})]}),(0,a.jsx)("div",{className:ec.content,children:(0,a.jsxs)("div",{className:ec.structureList,children:[t.map(e=>{let t=eu[e.type]||j.A;return(0,a.jsxs)("div",{className:ec.structureItem,children:[(0,a.jsx)(t,{className:ec.itemIcon}),(0,a.jsxs)("div",{className:ec.itemContent,children:[(0,a.jsx)("div",{className:ec.itemTitle,children:e.title}),(0,a.jsx)("div",{className:ec.itemType,children:"chapter"===e.type?"장":"scene"===e.type?"장면":"메모"})]})]},e.id)}),(0,a.jsxs)("button",{onClick:()=>{var e;let a={id:Date.now().toString(),projectId:(null==(e=t[0])?void 0:e.projectId)||"",type:"scene",title:"새 장면",isActive:!0,createdAt:new Date,updatedAt:new Date};r([...t,a])},className:ec.addButton,children:[(0,a.jsx)(w.A,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"새 항목 추가"})]})]})})]})}let ex={container:"flex-1 overflow-hidden bg-white dark:bg-gray-900",header:"p-6 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",title:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2",subtitle:"text-gray-600 dark:text-gray-400",content:"flex-1 overflow-y-auto p-6",characterGrid:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",characterCard:"group p-4 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg hover:shadow-sm hover:border-gray-300 dark:hover:border-gray-600 transition-all duration-200",characterHeader:"flex items-start justify-between mb-3",characterInfo:"flex-1",characterName:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-1",characterRole:"inline-flex items-center px-2 py-1 text-xs font-medium bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded",characterNotes:"text-gray-600 dark:text-gray-400 text-sm mt-2 line-clamp-3",addButton:"group flex flex-col items-center justify-center gap-2 p-6 bg-white dark:bg-gray-800 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg hover:border-blue-500 dark:hover:border-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-all duration-200 cursor-pointer",addButtonIcon:"w-5 h-5 text-gray-400 group-hover:text-blue-500 dark:group-hover:text-blue-400 transition-colors",addButtonText:"text-sm font-medium text-gray-600 dark:text-gray-400 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",editButton:"p-1.5 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",saveButton:"p-1.5 text-gray-400 hover:text-green-600 dark:hover:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 rounded transition-colors",cancelButton:"p-1.5 text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",editInput:"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-1 focus:ring-blue-500",editTextarea:"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-1 focus:ring-blue-500 resize-none"};function eh(e){let{projectId:t,characters:r,onCharactersChange:o}=e,[l,i]=(0,s.useState)(null),[d,c]=(0,s.useState)({}),u=async()=>{try{var e;let a={id:Date.now().toString(),projectId:(null==(e=r[0])?void 0:e.projectId)||t,name:"새 인물",role:"역할 미정",notes:"인물에 대한 설명을 추가하세요.",createdAt:new Date,updatedAt:new Date},s=await window.electronAPI.projects.upsertCharacter(a);if(s.success&&s.data)o([...r,s.data]),i(s.data.id),c(s.data),n.V.info("CHARACTERS_VIEW","New character saved to DB",{id:s.data.id});else throw Error(s.error||"Failed to create character")}catch(e){n.V.error("CHARACTERS_VIEW","Failed to create character",e),alert("캐릭터 생성에 실패했습니다.")}},g=e=>{i(e.id),c(e),n.V.debug("CHARACTERS_VIEW","Edit started",{id:e.id})},h=async()=>{if(l&&d)try{let e={...d,id:l,updatedAt:new Date},t=await window.electronAPI.projects.upsertCharacter(e);if(t.success&&t.data){let e=r.map(e=>e.id===l?t.data:e);o(e),i(null),c({}),n.V.info("CHARACTERS_VIEW","Character saved to DB",{id:l})}else throw Error(t.error||"Failed to save character")}catch(e){n.V.error("CHARACTERS_VIEW","Failed to save character",e),alert("캐릭터 저장에 실패했습니다.")}},b=()=>{i(null),c({}),n.V.debug("CHARACTERS_VIEW","Edit cancelled")};return(0,a.jsxs)("div",{className:ex.container,children:[(0,a.jsxs)("div",{className:ex.header,children:[(0,a.jsx)("h2",{className:ex.title,children:"등장인물"}),(0,a.jsx)("p",{className:ex.subtitle,children:"이야기의 등장인물들을 정리하고 관리하세요"})]}),(0,a.jsx)("div",{className:ex.content,children:(0,a.jsxs)("div",{className:ex.characterGrid,children:[r.map(e=>(0,a.jsx)("div",{className:ex.characterCard,children:(0,a.jsxs)("div",{className:ex.characterHeader,children:[(0,a.jsx)("div",{className:ex.characterInfo,children:l===e.id?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("input",{type:"text",value:d.name||"",onChange:e=>c(t=>({...t,name:e.target.value})),className:ex.editInput,placeholder:"인물 이름"}),(0,a.jsx)("input",{type:"text",value:d.role||"",onChange:e=>c(t=>({...t,role:e.target.value})),className:"".concat(ex.editInput," mt-2"),placeholder:"역할"}),(0,a.jsx)("textarea",{value:d.notes||"",onChange:e=>c(t=>({...t,notes:e.target.value})),className:"".concat(ex.editTextarea," mt-2"),placeholder:"인물 설명",rows:3})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h3",{className:ex.characterName,children:e.name}),(0,a.jsx)("span",{className:ex.characterRole,children:e.role}),(0,a.jsx)("p",{className:ex.characterNotes,children:e.notes})]})}),(0,a.jsx)("div",{className:"flex gap-1",children:l===e.id?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:h,className:ex.saveButton,title:"저장",children:(0,a.jsx)(P.A,{size:16})}),(0,a.jsx)("button",{onClick:b,className:ex.cancelButton,title:"취소",children:(0,a.jsx)(x.A,{size:16})})]}):(0,a.jsx)("button",{onClick:()=>g(e),className:ex.editButton,title:"편집",children:(0,a.jsx)(v.A,{size:16})})})]})},e.id)),(0,a.jsxs)("button",{onClick:u,className:ex.addButton,children:[(0,a.jsx)(w.A,{className:ex.addButtonIcon}),(0,a.jsx)("span",{className:ex.addButtonText,children:"새 인물 추가"})]})]})})]})}var eb=r(2784),em=r(4246);let ep={container:"flex-1 overflow-hidden bg-white dark:bg-gray-900",header:"p-6 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",title:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-2",subtitle:"text-gray-600 dark:text-gray-400",content:"flex-1 overflow-y-auto p-6",typeButtons:"flex gap-2 mb-6 flex-wrap",typeButton:"flex items-center gap-2 px-3 py-2 text-sm font-medium border border-gray-200 dark:border-gray-700 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",typeButtonActive:"bg-blue-600 text-white border-blue-600 hover:bg-blue-700",notesGrid:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",noteCard:"group p-4 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg hover:shadow-sm hover:border-gray-300 dark:hover:border-gray-600 transition-all duration-200",noteHeader:"flex items-center gap-3 mb-3",noteIcon:"w-5 h-5 text-blue-600 dark:text-blue-400",noteTitle:"font-medium text-gray-900 dark:text-gray-100 flex-1",noteContent:"text-gray-600 dark:text-gray-400 text-sm whitespace-pre-wrap line-clamp-4",noteDate:"text-xs text-gray-500 dark:text-gray-500 mt-3",addButton:"group flex flex-col items-center justify-center gap-2 p-6 bg-white dark:bg-gray-800 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg hover:border-blue-500 dark:hover:border-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-all duration-200 cursor-pointer min-h-[150px]",addButtonIcon:"w-6 h-6 text-gray-400 group-hover:text-blue-500 dark:group-hover:text-blue-400 transition-colors",addButtonText:"font-medium text-gray-600 dark:text-gray-400 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",addButtonSubtext:"text-sm text-gray-500 dark:text-gray-500 group-hover:text-blue-500 dark:group-hover:text-blue-400 transition-colors",editButton:"p-1.5 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors",saveButton:"p-1.5 text-gray-400 hover:text-green-600 dark:hover:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/20 rounded transition-colors",cancelButton:"p-1.5 text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",editInput:"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-1 focus:ring-blue-500",editTextarea:"w-full px-2 py-1 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-1 focus:ring-blue-500 resize-none"},ef=[{id:"1",projectId:"",title:"\uD83D\uDCA1 핵심 아이디어",content:"• 주인공의 숨겨진 과거\n• 반전 포인트 3개\n• 감정적 클라이맥스",type:"idea",createdAt:new Date,updatedAt:new Date},{id:"2",projectId:"",title:"\uD83C\uDFAF 스토리 목표",content:"독자가 느껴야 할 감정:\n- 긴장감\n- 경이로움\n- 카타르시스",type:"goal",createdAt:new Date,updatedAt:new Date},{id:"3",projectId:"",title:"\uD83D\uDCDD 참고 자료",content:"• 관련 영화: 인셉션, 매트릭스\n• 참고 소설: 1984\n• 연구 자료: 인공지능 윤리학",type:"reference",createdAt:new Date,updatedAt:new Date}],ey=[{id:"idea",label:"아이디어",icon:eb.A},{id:"goal",label:"목표",icon:em.A},{id:"reference",label:"참고",icon:f.A}];function ev(e){var t;let{projectId:r,notes:o,onNotesChange:l}=e,[i,d]=(0,s.useState)(o||ef.map(e=>({...e,projectId:r}))),[c,u]=(0,s.useState)("all"),[g,h]=(0,s.useState)(null),[b,m]=(0,s.useState)({}),p=e=>{h(e.id),m(e),n.V.debug("NOTES_VIEW","Edit started",{id:e.id})},f=()=>{if(!g||!b)return;let e=i.map(e=>e.id===g?{...e,...b,updatedAt:new Date}:e);d(e),h(null),m({}),l&&l(e),n.V.info("NOTES_VIEW","Note updated",{id:g})},y=()=>{h(null),m({}),n.V.debug("NOTES_VIEW","Edit cancelled")},j=e=>{let t=ey.find(t=>t.id===e);return t?t.icon:eb.A},k="all"===c?i:i.filter(e=>e.type===c);return(0,a.jsxs)("div",{className:ep.container,children:[(0,a.jsxs)("div",{className:ep.header,children:[(0,a.jsx)("h2",{className:ep.title,children:"작가 노트"}),(0,a.jsx)("p",{className:ep.subtitle,children:"아이디어, 목표, 참고 자료를 체계적으로 정리하세요"})]}),(0,a.jsxs)("div",{className:ep.content,children:[(0,a.jsxs)("div",{className:ep.typeButtons,children:[(0,a.jsx)("button",{onClick:()=>u("all"),className:"".concat(ep.typeButton," ").concat("all"===c?ep.typeButtonActive:""),children:"전체"}),ey.map(e=>{let t=e.icon;return(0,a.jsxs)("button",{onClick:()=>u(e.id),className:"".concat(ep.typeButton," ").concat(c===e.id?ep.typeButtonActive:""),children:[(0,a.jsx)(t,{size:16}),e.label]},e.id)})]}),(0,a.jsxs)("div",{className:ep.notesGrid,children:[k.map(e=>{let t=j(e.type);return(0,a.jsxs)("div",{className:ep.noteCard,children:[(0,a.jsxs)("div",{className:ep.noteHeader,children:[(0,a.jsx)(t,{className:ep.noteIcon}),g===e.id?(0,a.jsx)("input",{type:"text",value:b.title||"",onChange:e=>m(t=>({...t,title:e.target.value})),className:ep.editInput,placeholder:"메모 제목"}):(0,a.jsx)("h3",{className:ep.noteTitle,children:e.title}),(0,a.jsx)("div",{className:"flex gap-1",children:g===e.id?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:f,className:ep.saveButton,title:"저장",children:(0,a.jsx)(P.A,{size:16})}),(0,a.jsx)("button",{onClick:y,className:ep.cancelButton,title:"취소",children:(0,a.jsx)(x.A,{size:16})})]}):(0,a.jsx)("button",{onClick:()=>p(e),className:ep.editButton,title:"편집",children:(0,a.jsx)(v.A,{size:16})})})]}),g===e.id?(0,a.jsx)("textarea",{value:b.content||"",onChange:e=>m(t=>({...t,content:e.target.value})),className:ep.editTextarea,placeholder:"메모 내용",rows:6}):(0,a.jsx)("p",{className:ep.noteContent,children:e.content}),(0,a.jsx)("div",{className:ep.noteDate,children:e.updatedAt.toLocaleDateString()})]},e.id)}),(0,a.jsxs)("button",{onClick:()=>{let e={id:Date.now().toString(),projectId:r,title:"새 메모",content:"여기에 메모를 작성하세요...",type:"all"===c?"idea":c,createdAt:new Date,updatedAt:new Date},t=[...i,e];d(t),h(e.id),m(e),l&&l(t),n.V.info("NOTES_VIEW","New note added",{id:e.id})},className:ep.addButton,children:[(0,a.jsx)(w.A,{className:ep.addButtonIcon}),(0,a.jsx)("span",{className:ep.addButtonText,children:"새 메모 추가"}),(0,a.jsxs)("span",{className:ep.addButtonSubtext,children:["all"===c?"아이디어를":(null==(t=ey.find(e=>e.id===c))?void 0:t.label)+"를"," 기록하세요"]})]})]})]})]})}let ej=(e,t,r)=>{if(!e)return{wordCount:0,charCount:0,paragraphCount:0,readingTime:0,wordGoal:t,progress:0,sessionTime:0,wpm:0,headingCount:0,listItemCount:0};let a=e.split("\n"),s=e.split(/\s+/).filter(e=>e.length>0).length,o=e.length,n=e.split(/\n\s*\n/).filter(e=>e.trim().length>0).length,l=Math.ceil(s/200),i=Math.min(100,Math.round(s/t*100)),d=Math.max(1,(Date.now()-r)/1e3/60),c=Math.round(s/d),u=Math.floor(d);return{wordCount:s,charCount:o,paragraphCount:n,readingTime:l,wordGoal:t,progress:i,sessionTime:u,wpm:c,headingCount:a.filter(e=>e.match(/^#{1,6}\s/)).length,listItemCount:a.filter(e=>e.match(/^[\s]*[-*+]\s/)).length}};var ek=r(2287);let ew={container:"h-screen flex flex-col bg-white dark:bg-gray-900 transition-colors duration-200",main:"flex flex-1 overflow-hidden",editorContainer:"flex-1 flex flex-col h-full bg-white dark:bg-gray-900 transition-colors duration-200"},eT=(0,s.memo)(function(e){let{projectId:t}=e,{isLoading:r,error:o,...l}=function(e){let t=(0,s.useRef)(Date.now()),r=(0,s.useMemo)(()=>new Date,[]),a=(0,s.useMemo)(()=>[{id:"1",projectId:e,name:"주인공",role:"주요 인물",notes:"용감하고 정의로운 성격",createdAt:r,updatedAt:r},{id:"2",projectId:e,name:"조력자",role:"조력자",notes:"지혜롭고 경험이 많음",createdAt:r,updatedAt:r},{id:"3",projectId:e,name:"적대자",role:"적대자",notes:"야망이 크고 냉혹함",createdAt:r,updatedAt:r}],[e,r]),o=(0,s.useMemo)(()=>[{id:"1",projectId:e,title:"첫 번째 메모",content:"이야기의 핵심 아이디어를 여기에 적어보세요.",tags:["아이디어"],color:"#3b82f6",isPinned:!1,createdAt:r,updatedAt:r},{id:"2",projectId:e,title:"설정 노트",content:"세계관, 배경 설정에 대한 내용을 정리합니다.",tags:["설정","세계관"],color:"#10b981",isPinned:!0,createdAt:r,updatedAt:r}],[e,r]),l=(0,s.useMemo)(()=>[{id:"1",projectId:e,type:"chapter",title:"1장: 시작",isActive:!0,createdAt:r,updatedAt:r},{id:"2",projectId:e,type:"scene",title:"첫 번째 장면",isActive:!0,createdAt:r,updatedAt:r},{id:"3",projectId:e,type:"scene",title:"두 번째 장면",isActive:!0,createdAt:r,updatedAt:r},{id:"4",projectId:e,type:"chapter",title:"2장: 전개",isActive:!0,createdAt:r,updatedAt:r},{id:"5",projectId:e,type:"scene",title:"세 번째 장면",isActive:!0,createdAt:r,updatedAt:r},{id:"6",projectId:e,type:"note",title:"아이디어 메모",isActive:!0,createdAt:r,updatedAt:r}],[e,r]),[i,d]=(0,s.useState)(!0),[c,u]=(0,s.useState)(null),[g,x]=(0,s.useState)(""),[h,b]=(0,s.useState)(""),[m,p]=(0,s.useState)(null),[f,y]=(0,s.useState)("saved"),v=(0,s.useRef)(""),j=(0,s.useRef)(""),k=(0,s.useCallback)(e=>{v.current=e,x(e)},[]),w=(0,s.useCallback)(e=>{j.current=e,b(e)},[]),[T,C]=(0,s.useState)([]),[A,N]=(0,s.useState)([]),[E,D]=(0,s.useState)([]),[I,S]=(0,s.useState)({wordCount:0,charCount:0,paragraphCount:0,readingTime:0,wordGoal:1e3,progress:0,sessionTime:0,wpm:0}),R=(0,s.useCallback)(async()=>{try{d(!0),u(null),n.V.debug("PROJECT_DATA","Loading project",{projectId:e});let t=await window.electronAPI.projects.getById(e);if(t.success&&t.data){x(t.data.title),b(t.data.content),p(new Date(t.data.lastModified)),y("saved");try{let t=await window.electronAPI.projects.getCharacters(e);t.success&&t.data?(C(t.data),n.V.debug("PROJECT_DATA","Characters loaded successfully",{count:t.data.length})):(n.V.warn("PROJECT_DATA","No characters found, using defaults"),C(a))}catch(e){n.V.warn("PROJECT_DATA","Failed to load characters, using defaults",e),C(a)}try{let t=await window.electronAPI.projects.getStructure(e);t.success&&t.data?(N(t.data),n.V.debug("PROJECT_DATA","Structure loaded successfully",{count:t.data.length})):(n.V.warn("PROJECT_DATA","No structure found, using defaults"),N(l))}catch(e){n.V.warn("PROJECT_DATA","Failed to load structure, using defaults",e),N(l)}try{let t=await window.electronAPI.projects.getNotes(e);t.success&&t.data?(D(t.data),n.V.debug("PROJECT_DATA","Notes loaded successfully",{count:t.data.length})):(n.V.warn("PROJECT_DATA","No notes found, using defaults"),D(o))}catch(e){n.V.warn("PROJECT_DATA","Failed to load notes, using defaults",e),D(o)}n.V.info("PROJECT_DATA","Project loaded successfully")}else throw Error(t.error||"Failed to load project")}catch(t){n.V.error("PROJECT_DATA","Error loading project",t),u(t instanceof Error?t.message:"Failed to load project");try{let t=localStorage.getItem("project_backup_".concat(e));if(t){let e=JSON.parse(t);x(e.title||""),b(e.content||""),y("unsaved"),n.V.info("PROJECT_DATA","Loaded from local backup")}}catch(e){n.V.error("PROJECT_DATA","Failed to load backup",e)}}finally{d(!1)}},[e]),O=(0,s.useCallback)(async()=>{try{let t=v.current,r=j.current;if(!t.trim()&&!r.trim())return;n.V.debug("PROJECT_DATA","Saving project to server",{projectId:e});try{let a={title:t,content:r,lastModified:new Date};localStorage.setItem("project_backup_".concat(e),JSON.stringify(a)),n.V.debug("PROJECT_DATA","Local backup saved")}catch(e){n.V.warn("PROJECT_DATA","Failed to save local backup",e)}let a=await window.electronAPI.projects.update(e,{title:t,content:r,lastModified:new Date});if(a.success){p(new Date),y("saved"),n.V.info("PROJECT_DATA","Project saved successfully to server");try{localStorage.removeItem("project_backup_".concat(e))}catch(e){}}else throw Error(a.error||"Failed to save project")}catch(e){throw n.V.error("PROJECT_DATA","Error saving project",e),y("error"),e}},[e]),{debouncedSave:V,forceSave:_,isLoading:P}=function(e){let{projectId:t,delay:r=5e3,onSave:a,onSaveSuccess:o,onSaveError:l}=e,i=(0,s.useRef)(null),d=(0,s.useRef)(!1),c=(0,s.useRef)(0),u=(0,s.useRef)(0),g=(0,s.useCallback)(()=>{u.current=Date.now(),i.current&&clearTimeout(i.current),i.current=setTimeout(async()=>{let e=Date.now()-u.current;if(e<.9*r){n.V.debug("AUTO_SAVE","Still typing, postponing save",{projectId:t,timeSinceLastTyping:e,requiredDelay:r}),g();return}if(d.current)return void n.V.debug("AUTO_SAVE","Save already in progress, skipping",{projectId:t});try{d.current=!0;let r=Date.now();n.V.debug("AUTO_SAVE","\uD83D\uDCBE Starting auto-save (typing stopped)",{projectId:t,timeSinceLastTyping:e}),await a(),c.current=0;let s=Date.now()-r;n.V.info("AUTO_SAVE","✅ Auto-save completed",{projectId:t,duration:"".concat(s,"ms"),timeSinceLastTyping:e}),null==o||o()}catch(r){let e=r instanceof Error?r:Error(String(r));n.V.error("AUTO_SAVE","❌ Auto-save failed",e),c.current<3?(c.current++,n.V.warn("AUTO_SAVE","Retrying save (".concat(c.current,"/").concat(3,")"),{projectId:t}),setTimeout(()=>{g()},1e3*Math.pow(2,c.current))):(n.V.error("AUTO_SAVE","Max retries exceeded",{projectId:t}),null==l||l(e))}finally{d.current=!1,i.current=null}},r)},[t,r,a,o,l]),x=(0,s.useCallback)(async()=>{if(i.current&&(clearTimeout(i.current),i.current=null),d.current)return void n.V.debug("AUTO_SAVE","Save already in progress, cannot force save",{projectId:t});try{d.current=!0;let e=Date.now();n.V.info("AUTO_SAVE","Starting force save",{projectId:t}),await a(),c.current=0;let r=Date.now()-e;n.V.info("AUTO_SAVE","✅ Force save completed",{projectId:t,duration:"".concat(r,"ms")}),null==o||o()}catch(t){let e=t instanceof Error?t:Error(String(t));n.V.error("AUTO_SAVE","❌ Force save failed",e),null==l||l(e)}finally{d.current=!1}},[t,a,o,l]);return(0,s.useEffect)(()=>()=>{i.current&&clearTimeout(i.current)},[]),{debouncedSave:g,forceSave:x,isLoading:d.current}}({projectId:e,delay:3e3,onSave:O,onSaveSuccess:()=>{y("saved"),p(new Date),n.V.info("PROJECT_DATA","✅ 자동 저장 완료",{projectId:e})},onSaveError:t=>{y("error"),n.V.error("PROJECT_DATA","❌ 자동 저장 실패",{error:t.message,projectId:e});try{localStorage.setItem("project_backup_".concat(e),JSON.stringify({title:g,content:h})),n.V.info("PROJECT_DATA","\uD83D\uDCE6 로컬 백업 저장됨",{projectId:e})}catch(e){n.V.error("PROJECT_DATA","❌ 로컬 백업 실패",e)}}}),B=(0,s.useCallback)(async()=>{await _()},[_]),H=(0,s.useMemo)(()=>h?ej(h,I.wordGoal,t.current):I,[h,I.wordGoal,I]),F=(0,s.useCallback)(()=>{S(H)},[H]),L=(0,s.useCallback)(e=>{S(t=>({...t,wordGoal:e,progress:Math.min(100,Math.round(t.wordCount/e*100))}))},[]),J=(0,s.useRef)(R);J.current=R,(0,s.useEffect)(()=>{e&&J.current()},[e]);let M=(0,s.useRef)(V);M.current=V,(0,s.useEffect)(()=>{(g.trim()||h.trim())&&(y("unsaved"),M.current())},[g,h]),(0,s.useEffect)(()=>{P&&y("saving")},[P]),(0,s.useEffect)(()=>{F()},[]);let z=(0,s.useCallback)(async t=>{try{n.V.debug("PROJECT_DATA","Saving characters",{count:t.length});let r=await window.electronAPI.projects.updateCharacters(e,t);if(r.success)n.V.info("PROJECT_DATA","Characters saved successfully");else throw Error(r.error||"Failed to save characters")}catch(e){throw n.V.error("PROJECT_DATA","Error saving characters",e),e}},[e]),U=(0,s.useCallback)(async t=>{try{n.V.debug("PROJECT_DATA","Saving notes",{count:t.length});let r=await window.electronAPI.projects.updateNotes(e,t);if(r.success)n.V.info("PROJECT_DATA","Notes saved successfully");else throw Error(r.error||"Failed to save notes")}catch(e){throw n.V.error("PROJECT_DATA","Error saving notes",e),e}},[e]);return(0,s.useCallback)(async e=>{C(e);try{await z(e)}catch(e){n.V.error("PROJECT_DATA","Failed to save characters automatically",e)}},[z]),(0,s.useCallback)(async e=>{D(e);try{await U(e)}catch(e){n.V.error("PROJECT_DATA","Failed to save notes automatically",e)}},[U]),{isLoading:i,error:c,title:g,setTitle:k,content:h,setContent:w,lastSaved:m,saveStatus:f,characters:T,setCharacters:C,structure:A,setStructure:N,notes:E,setNotes:D,writerStats:I,loadProject:R,saveProject:B,forceSave:_,updateWriterStats:F,setWordGoal:L}}(t),i=function(){let{resolvedTheme:e,toggleTheme:t}=(0,ek.D)(),[r,a]=(0,s.useState)(!0),[o,l]=(0,s.useState)(!1),[i,d]=(0,s.useState)(!0),[c,u]=(0,s.useState)(!1),g=(0,s.useCallback)(()=>{a(e=>!e),n.V.debug("UI_STATE","Left sidebar toggled")},[]),x=(0,s.useCallback)(()=>{l(e=>!e),n.V.debug("UI_STATE","Right sidebar toggled")},[]);return{showLeftSidebar:r,showRightSidebar:o,showHeader:i,isDarkMode:"dark"===e,isFocusMode:c,toggleLeftSidebar:g,toggleRightSidebar:x,toggleDarkMode:(0,s.useCallback)(()=>{t(),n.V.debug("UI_STATE","Dark mode toggled via ThemeProvider")},[t]),toggleFocusMode:(0,s.useCallback)(()=>{u(e=>{let t=!e;return t&&(a(!1),l(!1)),n.V.info("UI_STATE","Focus mode ".concat(t?"enabled":"disabled")),t})},[]),setShowHeader:d}}(),[d,c]=(0,s.useState)("write"),[g,x]=(0,s.useState)(!1),[h,b]=(0,s.useState)(!1),[m,f]=(0,s.useState)(!1),y=(0,s.useRef)(null),[v,j]=(0,s.useState)(!1);(0,s.useCallback)(e=>{e&&(y.current=e),j(!0),n.V.info("PROJECT_EDITOR","Editor ready (fallback mode)")},[]);let k=(0,s.useCallback)(()=>window.history.back(),[]),w=(0,s.useCallback)(()=>x(e=>!e),[]),T=(0,s.useCallback)(()=>{f(!0),n.V.info("PROJECT_EDITOR","Share dialog opened")},[]),C=(0,s.useCallback)(()=>{b(!0),n.V.info("PROJECT_EDITOR","Delete confirmation dialog opened")},[]),A=(0,s.useCallback)(async()=>{try{n.V.info("PROJECT_EDITOR","Deleting project",{projectId:t});let e=await window.electronAPI.projects.delete(t);if(e.success)n.V.info("PROJECT_EDITOR","Project deleted successfully"),b(!1),window.history.back();else throw Error(e.error||"Failed to delete project")}catch(e){n.V.error("PROJECT_EDITOR","Failed to delete project",e)}},[t]),E=(0,s.useCallback)(()=>n.V.info("PROJECT_EDITOR","Download action"),[]),D=(0,s.useCallback)(e=>{n.V.info("PROJECT_EDITOR","View changed:",e),c(e)},[]);(0,s.useCallback)(e=>n.V.info("PROJECT_EDITOR","Toolbar action:",e),[]);let I=(0,s.useCallback)(e=>{let{key:t,ctrlKey:r,metaKey:a,shiftKey:s,altKey:o}=e,d=r||a;if(d&&"s"===t){e.preventDefault(),l.forceSave(),n.V.info("PROJECT_EDITOR","Save shortcut triggered");return}if(d&&"f"===t){e.preventDefault(),i.toggleFocusMode(),n.V.info("PROJECT_EDITOR","Focus mode shortcut triggered");return}if(d&&"b"===t){e.preventDefault(),x(e=>!e),n.V.info("PROJECT_EDITOR","Sidebar shortcut triggered");return}if(d&&"d"===t){e.preventDefault(),i.toggleDarkMode(),n.V.info("PROJECT_EDITOR","Dark mode shortcut triggered");return}if("Escape"===t){k(),n.V.info("PROJECT_EDITOR","Back shortcut triggered");return}if("F1"===t){e.preventDefault();let t=new CustomEvent("shortcut:help");window.dispatchEvent(t),n.V.info("PROJECT_EDITOR","Help shortcut triggered");return}},[l.forceSave,i.toggleFocusMode,i.toggleDarkMode,k]);return((0,s.useEffect)(()=>(window.addEventListener("keydown",I),()=>window.removeEventListener("keydown",I)),[I]),(0,s.useEffect)(()=>{let e=()=>{l.forceSave(),n.V.info("PROJECT_EDITOR","Project save triggered from editor")};return window.addEventListener("project:save",e),()=>window.removeEventListener("project:save",e)},[l.forceSave]),r)?(0,a.jsx)("div",{className:"h-screen flex items-center justify-center bg-white dark:bg-gray-900",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"프로젝트를 불러오는 중..."})]})}):o?(0,a.jsxs)("div",{className:"h-screen flex items-center justify-center text-red-500",children:["오류: ",o]}):(0,a.jsxs)(u,{children:[(0,a.jsxs)("div",{className:ew.container,children:[(0,a.jsx)(M,{title:l.title,onTitleChange:l.setTitle,onBack:k,sidebarCollapsed:g,onToggleSidebar:w,isFocusMode:i.isFocusMode,onToggleFocusMode:i.toggleFocusMode,onSave:l.forceSave,onShare:T,onDownload:E,onDelete:C}),(0,a.jsxs)("div",{className:ew.main,children:[!g&&(0,a.jsx)(N,{currentView:d,onViewChange:D,structure:l.structure,characters:l.characters,stats:l.writerStats,collapsed:!1}),(0,a.jsxs)("div",{className:ew.editorContainer,children:["write"===d&&(0,a.jsx)(el,{content:l.content,onChange:l.setContent,isFocusMode:i.isFocusMode}),"structure"===d&&(0,a.jsx)(eg,{structure:l.structure,onStructureChange:l.setStructure}),"characters"===d&&(0,a.jsx)(eh,{projectId:t,characters:l.characters,onCharactersChange:l.setCharacters}),"notes"===d&&(0,a.jsx)(ev,{projectId:t,notes:l.notes||[],onNotesChange:l.setNotes})]})]})]}),(0,a.jsx)(p,{}),(0,a.jsx)(W,{isOpen:h,projectTitle:l.title,onConfirm:A,onCancel:()=>b(!1)}),(0,a.jsx)(Q,{isOpen:m,projectTitle:l.title,projectId:t,onClose:()=>f(!1)})]})});function eC(){let e=(0,o.useParams)(),t=Array.isArray(e.id)?e.id[0]:e.id;return t?(n.V.debug("PROJECT_PAGE","Loading project page",{projectId:t}),(0,a.jsx)(eT,{projectId:t})):(n.V.error("PROJECT_PAGE","Missing project ID in route parameters"),(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"오류"}),(0,a.jsx)("p",{className:"text-slate-600",children:"프로젝트 ID가 없습니다."})]})}))}}},e=>{var t=t=>e(e.s=t);e.O(0,[209,149,795,805,813,192,350,615,70,313,809,952,101,464,478,742,816,621,391,76,358],()=>t(750)),_N_E=e.O()}]);