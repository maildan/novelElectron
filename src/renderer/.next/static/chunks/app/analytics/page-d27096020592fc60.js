(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[745],{722:(e,t,a)=>{Promise.resolve().then(a.bind(a,9890))},9890:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>v});var s=a(1659),l=a(9531),r=a(7826),i=a(597),c=a(2381),n=a(8587),o=a(4246),d=a(2204),m=a(8220),g=a(3362),u=a(6640),x=a(2792);let h={container:"container mx-auto px-4 py-6 max-w-7xl space-y-6",pageTitle:"text-3xl font-bold text-slate-900 dark:text-slate-100 mb-6",kpiGrid:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",chartsGrid:"grid grid-cols-1 lg:grid-cols-3 gap-6",chartCard:"p-6",chartTitle:"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-4",chartPlaceholder:"h-64 bg-slate-100 dark:bg-slate-800 rounded-lg flex items-center justify-center text-slate-500 dark:text-slate-400",progressGrid:"grid grid-cols-1 md:grid-cols-2 gap-6",progressItem:"flex items-center justify-between p-4 bg-slate-50 dark:bg-slate-800 rounded-lg",progressLabel:"font-medium text-slate-900 dark:text-slate-100",progressValue:"text-sm text-slate-600 dark:text-slate-400 ml-4",goalCard:"p-6 bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-950 dark:to-purple-950",goalTitle:"text-xl font-bold text-slate-900 dark:text-slate-100 mb-2",goalDescription:"text-slate-600 dark:text-slate-400 mb-4",goalProgress:"space-y-3",goalItem:"flex items-center justify-between",goalLabel:"text-sm font-medium text-slate-700 dark:text-slate-300",goalPercentage:"text-sm text-slate-500 dark:text-slate-400"},p={kpis:{dailyWords:0,totalWords:0,avgWpm:0,activeProjects:0,sessionTime:0,accuracy:0,weeklyGoal:0,improvementRate:0},weeklyData:[0,0,0,0,0,0,0],projectProgress:[],goals:[{label:"일일 목표 (3000자)",current:0,target:3e3},{label:"주간 목표 (20000자)",current:0,target:2e4},{label:"정확도 목표 (95%)",current:0,target:95},{label:"WPM 목표 (90)",current:0,target:90}]};function v(){let[e,t]=l.useState(p),[a,v]=l.useState(!0),[b,j]=l.useState(null);l.useEffect(()=>{x.V.info("ANALYTICS_PAGE","Analytics page loaded"),y()},[]);let y=async()=>{try{var e,a;v(!0),j(null);let s=await window.electronAPI.dashboard.getStats(),l=await window.electronAPI.keyboard.getRealtimeStats(),r=await window.electronAPI.keyboard.getStatus(),i=await window.electronAPI.dashboard.getRecentSessions();if(!s.success)throw Error("Dashboard stats failed: ".concat(s.error));if(!l.success)throw Error("Realtime stats failed: ".concat(l.error));if(!r.success)throw Error("Keyboard status failed: ".concat(r.error));if(!i.success)throw Error("Recent sessions failed: ".concat(i.error));let c=k(s.data,[],i.data||[]);if(l.data&&(c.kpis.avgWpm=l.data.currentWpm||0,c.kpis.accuracy=l.data.accuracy||0,c.kpis.sessionTime=(l.data.sessionTime||0)/3600),(null==(e=r.data)?void 0:e.isActive)&&r.data.startTime){let e=new Date(r.data.startTime),t=(Date.now()-e.getTime())/1e3;c.kpis.sessionTime=t/3600}t(c),x.V.info("ANALYTICS","✅ Analytics data loaded successfully",{dailyWords:c.kpis.dailyWords,avgWpm:c.kpis.avgWpm,accuracy:c.kpis.accuracy,sessionsCount:(null==(a=i.data)?void 0:a.length)||0})}catch(e){x.V.error("ANALYTICS","❌ Failed to load analytics data",e),j("데이터 로딩 실패: ".concat(e.message)),t(p)}finally{v(!1)}},k=(e,t,a)=>{let s=a||[],l=f(s),r=N(t||[]);return{kpis:{dailyWords:(null==e?void 0:e.todayWords)||0,totalWords:(null==e?void 0:e.monthWords)||0,avgWpm:(null==e?void 0:e.avgWpm)||0,activeProjects:(null==e?void 0:e.activeProjects)||0,sessionTime:w(s),accuracy:(null==e?void 0:e.accuracy)||0,weeklyGoal:T(l),improvementRate:A(s)},weeklyData:l,projectProgress:r,goals:[{label:"일일 목표 (3000자)",current:(null==e?void 0:e.todayWords)||0,target:3e3},{label:"주간 목표 (20000자)",current:(null==e?void 0:e.weekWords)||0,target:2e4},{label:"정확도 목표 (95%)",current:(null==e?void 0:e.accuracy)||0,target:95},{label:"WPM 목표 (90)",current:(null==e?void 0:e.avgWpm)||0,target:90}]}},f=e=>{let t=Array(7).fill(0);return(null==e?void 0:e.length)&&e.forEach(e=>{if(e.createdAt){let a=new Date(e.createdAt).getDay();t[a]+=e.keyCount||0}}),t},N=e=>{if(!(null==e?void 0:e.length))return[];let t=["blue","green","purple","orange","red"];return e.slice(0,5).map((e,a)=>({name:String(e.title||"제목 없음"),progress:Number(e.progress||0),color:t[a%t.length]||"blue"}))},w=e=>(null==e?void 0:e.length)?e.reduce((e,t)=>t.startTime&&t.endTime?e+(new Date(t.endTime).getTime()-new Date(t.startTime).getTime())/6e4:e,0)/60:0,T=e=>Math.min(e.reduce((e,t)=>e+t,0)/2e4*100,100),A=e=>{if(!(null==e?void 0:e.length)||e.length<2)return 0;let t=e.slice(0,Math.min(10,e.length)),a=e.slice(10,Math.min(20,e.length));if(!a.length)return 0;let s=t.reduce((e,t)=>e+(t.wpm||0),0)/t.length,l=a.reduce((e,t)=>e+(t.wpm||0),0)/a.length;return 0===l?0:(s-l)/l*100},W=e=>new Intl.NumberFormat("ko-KR").format(e),P=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e.toFixed(t)};return a?(0,s.jsx)("div",{className:h.container,children:(0,s.jsx)("div",{className:"flex items-center justify-center min-h-96",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-lg text-slate-600 dark:text-slate-400",children:"분석 데이터를 불러오는 중..."})]})})}):b?(0,s.jsx)("div",{className:h.container,children:(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-96 text-center",children:[(0,s.jsx)("h3",{className:"text-xl font-semibold text-red-600 dark:text-red-400 mb-2",children:"데이터 로딩 실패"}),(0,s.jsx)("p",{className:"text-slate-600 dark:text-slate-400 mb-4",children:b}),(0,s.jsx)("button",{onClick:y,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"다시 시도"})]})}):(0,s.jsxs)("div",{className:h.container,children:[(0,s.jsx)("h1",{className:h.pageTitle,children:"분석 및 통계"}),(0,s.jsxs)("div",{className:h.kpiGrid,children:[(0,s.jsx)(m.n,{title:"오늘 작성한 글자",value:W(e.kpis.dailyWords),icon:c.A,color:"blue",change:{value:12.5,type:"increase",period:"어제 대비"}}),(0,s.jsx)(m.n,{title:"총 작성한 글자",value:W(e.kpis.totalWords),icon:r.A,color:"green",change:{value:8.3,type:"increase",period:"이번 주"}}),(0,s.jsx)(m.n,{title:"평균 타자 속도",value:"".concat(P(e.kpis.avgWpm)," WPM"),icon:d.A,color:"purple",change:{value:4.2,type:"increase",period:"지난 주 대비"}}),(0,s.jsx)(m.n,{title:"활성 프로젝트",value:e.kpis.activeProjects,icon:o.A,color:"orange",change:{value:0,type:"neutral",period:"변화 없음"}})]}),(0,s.jsxs)("div",{className:h.chartsGrid,children:[(0,s.jsxs)(g.Z,{className:"".concat(h.chartCard," lg:col-span-2"),children:[(0,s.jsx)("h3",{className:h.chartTitle,children:"주간 작성량 추이"}),(0,s.jsx)("div",{className:h.chartPlaceholder,children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(i.A,{className:"w-12 h-12 mx-auto mb-2"}),(0,s.jsx)("p",{children:"차트 구현 예정"}),(0,s.jsxs)("p",{className:"text-xs mt-1",children:["이번 주 평균: ",W(e.weeklyData.reduce((e,t)=>e+t,0)/7),"자/일"]})]})})]}),(0,s.jsxs)(g.Z,{className:h.chartCard,children:[(0,s.jsx)("h3",{className:h.chartTitle,children:"프로젝트 진행률"}),(0,s.jsx)("div",{className:"space-y-4",children:e.projectProgress.map((e,t)=>(0,s.jsxs)("div",{className:h.progressItem,children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:h.progressLabel,children:e.name}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)(u.z,{value:e.progress,color:e.color,size:"sm"})})]}),(0,s.jsxs)("div",{className:h.progressValue,children:[P(e.progress),"%"]})]},t))})]})]}),(0,s.jsxs)("div",{className:h.progressGrid,children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsx)(m.n,{title:"세션 시간",value:"".concat(P(e.kpis.sessionTime),"h"),icon:n.A,color:"blue",change:{value:15.2,type:"increase",period:"어제 대비"}}),(0,s.jsx)(m.n,{title:"정확도",value:"".concat(P(e.kpis.accuracy),"%"),icon:o.A,color:"green",change:{value:2.1,type:"increase",period:"지난 주 대비"}})]}),(0,s.jsxs)(g.Z,{className:h.goalCard,children:[(0,s.jsx)("h3",{className:h.goalTitle,children:"목표 달성률"}),(0,s.jsxs)("p",{className:h.goalDescription,children:["이번 주 전체 목표 달성률: ",P(e.kpis.weeklyGoal),"%"]}),(0,s.jsx)("div",{className:h.goalProgress,children:e.goals.map((e,t)=>{let a=Math.min(e.current/e.target*100,100),l=a>=100;return(0,s.jsxs)("div",{className:h.goalItem,children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:h.goalLabel,children:e.label}),(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(u.z,{value:a,color:l?"green":"blue",size:"sm"})})]}),(0,s.jsxs)("div",{className:h.goalPercentage,children:[P(a),"%"]})]},t)})})]})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[209,149,795,805,813,192,350,615,70,313,809,952,101,464,478,742,816,621,391,76,358],()=>t(722)),_N_E=e.O()}]);