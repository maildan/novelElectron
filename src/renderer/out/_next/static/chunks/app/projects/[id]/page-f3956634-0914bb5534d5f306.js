(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[588],{1125:(e,t,o)=>{"use strict";o.d(t,{FW:()=>n.A,Hs:()=>l.A,T5:()=>a.A,Vn:()=>i.A,c_:()=>r.A,kr:()=>s.A,sU:()=>d.A,vE:()=>c.A,zW:()=>u.A});var r=o(7911),s=o(9369),a=o(869),c=o(3908),l=o(1855),n=o(4529),i=o(3755),d=o(1778),u=o(2055)},1324:(e,t,o)=>{"use strict";o.d(t,{default:()=>b});var r=o(4568),s=o(7620),a=o(2942),c=o(6034),l=o(7959),n=o(6948),i=o(6580),d=o(9811),u=o(5302),g=o(6293),h=o(1159),f=o(1357),E=o(8856),A=o(5829),p=o(662),D=o(3608),v=o(3699);let R={container:"h-screen flex flex-col bg-white dark:bg-gray-900 transition-colors duration-200",main:"flex flex-1 overflow-hidden",editorContainer:"flex-1 flex flex-col h-full bg-white dark:bg-gray-900 transition-colors duration-200"},C=(0,s.memo)(function(e){let{projectId:t}=e;p.V.info("PROJECT_EDITOR","ProjectEditor render started",{projectId:t});let{isLoading:o,error:a,...C}=(0,D.B)(t),x=(0,v.F)(),[b,T]=(0,s.useState)("write"),[m,O]=(0,s.useState)(!1),[w,j]=(0,s.useState)(!1),[y,I]=(0,s.useState)(!1),[k,P]=(0,s.useState)(!1),_=(0,s.useRef)(null),[S,J]=(0,s.useState)(!1),[V,N]=(0,s.useState)(!1),[G,F]=(0,s.useState)(null),[M,U]=(0,s.useState)(!1),[W,B]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=async()=>{try{var e,o;let r=await (null==(o=window.electronAPI)||null==(e=o.projects)?void 0:e.getById(t));(null==r?void 0:r.success)&&r.data&&B(r.data)}catch(e){p.V.error("PROJECT_EDITOR","Failed to load full project data",e)}};t&&e()},[t]),(0,s.useEffect)(()=>{if(null==W?void 0:W.description)try{let e=W.description.match(RegExp("\\[Google Docs 연동 정보: (\\{.*\\})\\]$","s"));if(e&&e[1]){let t=JSON.parse(e[1]);t&&t.isGoogleDocsProject&&(N(!0),F(t),p.V.info("PROJECT_EDITOR","Google Docs project detected",{googleDocId:t.googleDocId,googleDocUrl:t.googleDocUrl}))}}catch(e){p.V.debug("PROJECT_EDITOR","Google Docs 메타데이터 파싱 실패",{err:e,projectId:t})}},[null==W?void 0:W.description,t]);let L=(0,s.useCallback)(async()=>{if(V&&(null==G?void 0:G.googleDocId)){U(!0);try{var e,t,o;p.V.info("PROJECT_EDITOR","Syncing with Google Docs",{googleDocId:G.googleDocId});let r=await (null==(t=window.electronAPI)||null==(e=t.oauth)?void 0:e.importGoogleDoc(G.googleDocId));(null==r?void 0:r.success)&&(null==(o=r.data)?void 0:o.content)?(C.setContent(r.data.content),await C.forceSave(),p.V.info("PROJECT_EDITOR","Google Docs sync completed",{contentLength:r.data.content.length})):p.V.warn("PROJECT_EDITOR","Google Docs sync failed",null==r?void 0:r.error)}catch(e){p.V.error("PROJECT_EDITOR","Google Docs sync error",e)}finally{U(!1)}}},[V,null==G?void 0:G.googleDocId,C]);(0,s.useCallback)(async e=>{if(V&&(null==G?void 0:G.googleDocId))try{p.V.info("PROJECT_EDITOR","Updating Google Docs",{googleDocId:G.googleDocId,contentLength:e.length})}catch(e){p.V.error("PROJECT_EDITOR","Google Docs update error",e)}},[V,null==G?void 0:G.googleDocId]);let X=(0,s.useCallback)(()=>{if(null==G?void 0:G.googleDocUrl)try{var e,t;(null==(t=window.electronAPI)||null==(e=t.shell)?void 0:e.openExternal)?window.electronAPI.shell.openExternal(G.googleDocUrl):window.open(G.googleDocUrl,"_blank","noopener"),p.V.info("PROJECT_EDITOR","Opened Google Docs externally",{url:G.googleDocUrl})}catch(e){p.V.error("PROJECT_EDITOR","Failed to open Google Docs",e)}},[null==G?void 0:G.googleDocUrl]);(0,s.useCallback)(e=>{e&&(_.current=e),J(!0),p.V.info("PROJECT_EDITOR","Editor ready (fallback mode)")},[]);let z=(0,s.useCallback)(()=>window.history.back(),[]),H=(0,s.useCallback)(()=>O(e=>!e),[]),Q=(0,s.useCallback)(()=>{j(e=>!e),p.V.info("PROJECT_EDITOR","AI sidebar ".concat(w?"closed":"opened"))},[w]),K=(0,s.useCallback)(()=>{P(!0),p.V.info("PROJECT_EDITOR","Share dialog opened")},[]),Z=(0,s.useCallback)(()=>{I(!0),p.V.info("PROJECT_EDITOR","Delete confirmation dialog opened")},[]),Y=(0,s.useCallback)(async()=>{try{p.V.info("PROJECT_EDITOR","Deleting project",{projectId:t});let e=await window.electronAPI.projects.delete(t);if(e.success)p.V.info("PROJECT_EDITOR","Project deleted successfully"),I(!1),window.history.back();else throw Error(e.error||"Failed to delete project")}catch(e){p.V.error("PROJECT_EDITOR","Failed to delete project",e)}},[t]),$=(0,s.useCallback)(async()=>{try{let e=C.content||"",t=C.title||"제목없음",o=new Blob([e],{type:"text/markdown;charset=utf-8"}),r=URL.createObjectURL(o),s=document.createElement("a");s.href=r,s.download="".concat(t.replace(/[^a-zA-Z0-9가-힣\s]/g,"_"),".md"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r),p.V.info("PROJECT_EDITOR","Project exported as markdown",{title:t})}catch(e){p.V.error("PROJECT_EDITOR","Export failed",e)}},[C.content,C.title]),q=(0,s.useCallback)(e=>{p.V.info("PROJECT_EDITOR","View changed:",e),T(e)},[]);(0,s.useCallback)(e=>p.V.info("PROJECT_EDITOR","Toolbar action:",e),[]);let ee=(0,s.useCallback)(e=>{let{key:t,ctrlKey:o,metaKey:r,shiftKey:s,altKey:a}=e,c=o||r;if(c&&"s"===t){e.preventDefault(),C.forceSave(),p.V.info("PROJECT_EDITOR","Save shortcut triggered");return}if(c&&"f"===t){e.preventDefault(),x.toggleFocusMode(),p.V.info("PROJECT_EDITOR","Focus mode shortcut triggered");return}if(c&&"b"===t){e.preventDefault(),O(e=>!e),p.V.info("PROJECT_EDITOR","Sidebar shortcut triggered");return}if(c&&"d"===t){e.preventDefault(),x.toggleDarkMode(),p.V.info("PROJECT_EDITOR","Dark mode shortcut triggered");return}if("Escape"===t){if(y||k)return;if(x.isFocusMode){e.preventDefault(),x.toggleFocusMode(),p.V.info("PROJECT_EDITOR","Focus mode disabled by ESC");return}let t=new CustomEvent("global:escape",{detail:{source:"ProjectEditor"}});window.dispatchEvent(t),e.preventDefault(),z(),p.V.info("PROJECT_EDITOR","Back shortcut triggered");return}if("F1"===t){e.preventDefault();let t=new CustomEvent("shortcut:help");window.dispatchEvent(t),p.V.info("PROJECT_EDITOR","Help shortcut triggered");return}},[C.forceSave,x.toggleFocusMode,x.toggleDarkMode,z]);return((0,s.useEffect)(()=>(window.addEventListener("keydown",ee),()=>window.removeEventListener("keydown",ee)),[ee]),(0,s.useEffect)(()=>{let e=()=>{C.forceSave(),p.V.info("PROJECT_EDITOR","Project save triggered from editor")};return window.addEventListener("project:save",e),()=>window.removeEventListener("project:save",e)},[C.forceSave]),o)?(0,r.jsx)("div",{className:"h-screen flex items-center justify-center bg-white dark:bg-gray-900",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-8 h-8 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"프로젝트를 불러오는 중..."})]})}):a?(0,r.jsxs)("div",{className:"h-screen flex items-center justify-center text-red-500",children:["오류: ",a]}):(0,r.jsxs)(c.z,{children:[(0,r.jsxs)("div",{className:R.container,children:[(0,r.jsx)(d.z,{title:C.title,onTitleChange:C.setTitle,onBack:z,sidebarCollapsed:m,onToggleSidebar:H,showRightSidebar:w,onToggleAISidebar:Q,isFocusMode:x.isFocusMode,onToggleFocusMode:x.toggleFocusMode,onSave:C.forceSave,onShare:K,onDownload:$,onDelete:Z,isGoogleDocsProject:V,googleDocMeta:G,isSyncingWithGoogle:M,onSyncWithGoogle:L,onOpenGoogleDocs:X}),(0,r.jsxs)("div",{className:R.main,children:[!m&&(0,r.jsx)(n.m,{currentView:b,onViewChange:q,structure:C.structure,characters:C.characters,stats:C.writerStats,collapsed:!1}),(0,r.jsxs)("div",{className:R.editorContainer,children:["write"===b&&(0,r.jsx)(h.L,{content:C.content,onChange:C.setContent,isFocusMode:x.isFocusMode}),"structure"===b&&(0,r.jsx)(f.l,{structure:C.structure,onStructureChange:C.setStructure}),"characters"===b&&(0,r.jsx)(E.E,{projectId:t,characters:C.characters,onCharactersChange:C.setCharacters}),"notes"===b&&(0,r.jsx)(A.d,{projectId:t,notes:C.notes||[],onNotesChange:C.setNotes})]}),(0,r.jsx)(i.H,{showRightSidebar:w,toggleRightSidebar:Q,writerStats:C.writerStats,setWordGoal:C.setWordGoal,currentText:C.content,projectId:t})]})]}),(0,r.jsx)(l.S,{}),(0,r.jsx)(u.K,{isOpen:y,projectTitle:C.title,onConfirm:Y,onCancel:()=>I(!1)}),(0,r.jsx)(g.G,{isOpen:k,projectTitle:C.title,projectId:t,onClose:()=>P(!1)})]})});class x extends s.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t}),p.V.error("PROJECT_ERROR_BOUNDARY","Client-side exception caught",{error:e.message,stack:e.stack,componentStack:t.componentStack}),console.error("\uD83D\uDEA8 ProjectErrorBoundary caught an error:",e),console.error("Error Info:",t),console.error("Component Stack:",t.componentStack)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:(0,r.jsx)("div",{className:"h-screen flex items-center justify-center bg-white dark:bg-gray-900",children:(0,r.jsxs)("div",{className:"max-w-md text-center p-6",children:[(0,r.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDE35"}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"앗! 오류가 발생했습니다"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"클라이언트에서 예외가 발생했습니다. 페이지를 새로고침하거나 다시 시도해보세요."}),!1,(0,r.jsxs)("div",{className:"space-x-4",children:[(0,r.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"페이지 새로고침"}),(0,r.jsx)("button",{onClick:()=>window.history.back(),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"뒤로 가기"})]})]})}):this.props.children}constructor(e){super(e),this.state={hasError:!1}}}function b(){let e=(0,a.useParams)(),t=(0,a.useSearchParams)(),o=Array.isArray(e.id)?e.id[0]:e.id,s=t.get("open")||t.get("id")||void 0,c="new"===o&&s?s:o||s;return c?(p.V.debug("PROJECT_PAGE","Loading project page",{projectId:c}),(0,r.jsx)(x,{children:(0,r.jsx)(C,{projectId:c})})):(p.V.error("PROJECT_PAGE","Missing project ID in route parameters"),(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"오류"}),(0,r.jsx)("p",{className:"text-slate-600",children:"프로젝트 ID가 없습니다."})]})}))}},1604:(e,t,o)=>{"use strict";o.d(t,{J0:()=>r.useState,Kr:()=>r.useMemo,hb:()=>r.useCallback,li:()=>r.useRef,vJ:()=>r.useEffect});var r=o(7620)},1964:(e,t,o)=>{"use strict";o.d(t,{AX:()=>i.A,Bx:()=>h.A,Es:()=>s.A,Gr:()=>c.A,JG:()=>r.A,QR:()=>a.A,TB:()=>A.A,_H:()=>g.A,bd:()=>E.A,e9:()=>d.A,eM:()=>u.A,h1:()=>n.A,ni:()=>l.A,sU:()=>f.A});var r=o(5870),s=o(6090),a=o(6608),c=o(5685),l=o(9878),n=o(584),i=o(3672),d=o(7469),u=o(2935),g=o(2187),h=o(281),f=o(1778),E=o(3642),A=o(8262)},2735:(e,t,o)=>{"use strict";o.d(t,{B8:()=>h.A,Cy:()=>c.A,Hs:()=>f.A,MD:()=>u.A,Pk:()=>E.A,SE:()=>s.A,Vw:()=>l.A,X:()=>p.A,ZU:()=>A.A,_:()=>n.A,_B:()=>d.A,fV:()=>i.A,g5:()=>g.A,hc:()=>r.A,yQ:()=>a.A});var r=o(9966),s=o(7804),a=o(4711),c=o(8976),l=o(853),n=o(7419),i=o(8406),d=o(8110),u=o(8464),g=o(952),h=o(6285),f=o(1855),E=o(1627),A=o(5421),p=o(2463)},3930:(e,t,o)=>{"use strict";o.d(t,{FW:()=>n.A,Gy:()=>r.A,W7:()=>a.A,a4:()=>l.A,iU:()=>c.A,jl:()=>s.A,zW:()=>i.A});var r=o(3643),s=o(1261),a=o(9877),c=o(3425),l=o(1690),n=o(4529),i=o(2055)},4862:(e,t,o)=>{Promise.resolve().then(o.bind(o,1324))},5454:(e,t,o)=>{"use strict";o.d(t,{FW:()=>s.A,W7:()=>r.A,X:()=>c.A,eM:()=>a.A});var r=o(9877),s=o(4529),a=o(2935),c=o(2463)},5665:(e,t,o)=>{"use strict";o.d(t,{B0:()=>s.A,Cy:()=>a.A,Gk:()=>g.A,J2:()=>n.A,N_:()=>i.A,Pk:()=>u.A,QR:()=>c.A,a4:()=>d.A,xf:()=>l.A,yN:()=>r.A,z2:()=>h.A});var r=o(4558),s=o(2077),a=o(8976),c=o(6608),l=o(4642),n=o(2907),i=o(5009),d=o(1690),u=o(1627),g=o(260),h=o(3267)},6583:(e,t,o)=>{"use strict";o.d(t,{Jl:()=>r.A,QR:()=>s.A,X:()=>n.A,_H:()=>l.A,f5:()=>a.A,gE:()=>c.A});var r=o(4931),s=o(6608),a=o(3385),c=o(5774),l=o(2187),n=o(2463)},6856:(e,t,o)=>{"use strict";o.d(t,{X:()=>s.A,h:()=>r.A});var r=o(9966),s=o(2463)},7099:(e,t,o)=>{"use strict";o.d(t,{J0:()=>r.useState,hb:()=>r.useCallback});var r=o(7620)},7517:(e,t,o)=>{"use strict";o.d(t,{FW:()=>i.A,Pt:()=>c.A,TB:()=>d.A,Vw:()=>n.A,Xh:()=>r.A,c_:()=>a.A,iU:()=>l.A,yQ:()=>s.A});var r=o(9457),s=o(4711),a=o(7911),c=o(1164),l=o(3425),n=o(853),i=o(4529),d=o(8262)},8627:(e,t,o)=>{"use strict";o.d(t,{X:()=>a.A,m:()=>s.A,o:()=>r.A});var r=o(8130),s=o(4282),a=o(2463)},9737:(e,t,o)=>{"use strict";o.d(t,{FW:()=>c.A,Gy:()=>r.A,W7:()=>s.A,We:()=>n.A,X:()=>i.A,eM:()=>l.A,g5:()=>a.A});var r=o(3643),s=o(9877),a=o(952),c=o(4529),l=o(2935),n=o(3052),i=o(2463)},9897:(e,t,o)=>{"use strict";o.d(t,{hb:()=>r.useCallback,li:()=>r.useRef,vJ:()=>r.useEffect});var r=o(7620)}}]);