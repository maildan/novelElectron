(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[588],{1324:(e,t,r)=>{"use strict";r.d(t,{default:()=>j});var s=r(4568),o=r(7620),a=r(2942),c=r(6034),n=r(7959),i=r(6948),l=r(6580),d=r(9811),u=r(5302),h=r(6293),A=r(1159),f=r(1357),g=r(8856),x=r(5829),E=r(662),b=r(3608),m=r(3699);let p={container:"h-screen flex flex-col bg-white dark:bg-gray-900 transition-colors duration-200",main:"flex flex-1 overflow-hidden",editorContainer:"flex-1 flex flex-col h-full bg-white dark:bg-gray-900 transition-colors duration-200"},C=(0,o.memo)(function(e){let{projectId:t}=e,{isLoading:r,error:a,...C}=(0,b.B)(t),v=(0,m.F)(),[j,R]=(0,o.useState)("write"),[w,k]=(0,o.useState)(!1),[T,O]=(0,o.useState)(!1),[D,y]=(0,o.useState)(!1),[S,P]=(0,o.useState)(!1),_=(0,o.useRef)(null),[I,J]=(0,o.useState)(!1);(0,o.useCallback)(e=>{e&&(_.current=e),J(!0),E.V.info("PROJECT_EDITOR","Editor ready (fallback mode)")},[]);let V=(0,o.useCallback)(()=>window.history.back(),[]),N=(0,o.useCallback)(()=>k(e=>!e),[]),F=(0,o.useCallback)(()=>{O(e=>!e),E.V.info("PROJECT_EDITOR","AI sidebar ".concat(T?"closed":"opened"))},[T]),M=(0,o.useCallback)(()=>{P(!0),E.V.info("PROJECT_EDITOR","Share dialog opened")},[]),W=(0,o.useCallback)(()=>{y(!0),E.V.info("PROJECT_EDITOR","Delete confirmation dialog opened")},[]),B=(0,o.useCallback)(async()=>{try{E.V.info("PROJECT_EDITOR","Deleting project",{projectId:t});let e=await window.electronAPI.projects.delete(t);if(e.success)E.V.info("PROJECT_EDITOR","Project deleted successfully"),y(!1),window.history.back();else throw Error(e.error||"Failed to delete project")}catch(e){E.V.error("PROJECT_EDITOR","Failed to delete project",e)}},[t]),L=(0,o.useCallback)(async()=>{try{let e=C.content||"",t=C.title||"제목없음",r=new Blob([e],{type:"text/markdown;charset=utf-8"}),s=URL.createObjectURL(r),o=document.createElement("a");o.href=s,o.download="".concat(t.replace(/[^a-zA-Z0-9가-힣\s]/g,"_"),".md"),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(s),E.V.info("PROJECT_EDITOR","Project exported as markdown",{title:t})}catch(e){E.V.error("PROJECT_EDITOR","Export failed",e)}},[C.content,C.title]),U=(0,o.useCallback)(e=>{E.V.info("PROJECT_EDITOR","View changed:",e),R(e)},[]);(0,o.useCallback)(e=>E.V.info("PROJECT_EDITOR","Toolbar action:",e),[]);let G=(0,o.useCallback)(e=>{let{key:t,ctrlKey:r,metaKey:s,shiftKey:o,altKey:a}=e,c=r||s;if(c&&"s"===t){e.preventDefault(),C.forceSave(),E.V.info("PROJECT_EDITOR","Save shortcut triggered");return}if(c&&"f"===t){e.preventDefault(),v.toggleFocusMode(),E.V.info("PROJECT_EDITOR","Focus mode shortcut triggered");return}if(c&&"b"===t){e.preventDefault(),k(e=>!e),E.V.info("PROJECT_EDITOR","Sidebar shortcut triggered");return}if(c&&"d"===t){e.preventDefault(),v.toggleDarkMode(),E.V.info("PROJECT_EDITOR","Dark mode shortcut triggered");return}if("Escape"===t){if(D||S)return;if(v.isFocusMode){e.preventDefault(),v.toggleFocusMode(),E.V.info("PROJECT_EDITOR","Focus mode disabled by ESC");return}let t=new CustomEvent("global:escape",{detail:{source:"ProjectEditor"}});window.dispatchEvent(t),e.preventDefault(),V(),E.V.info("PROJECT_EDITOR","Back shortcut triggered");return}if("F1"===t){e.preventDefault();let t=new CustomEvent("shortcut:help");window.dispatchEvent(t),E.V.info("PROJECT_EDITOR","Help shortcut triggered");return}},[C.forceSave,v.toggleFocusMode,v.toggleDarkMode,V]);return((0,o.useEffect)(()=>(window.addEventListener("keydown",G),()=>window.removeEventListener("keydown",G)),[G]),(0,o.useEffect)(()=>{let e=()=>{C.forceSave(),E.V.info("PROJECT_EDITOR","Project save triggered from editor")};return window.addEventListener("project:save",e),()=>window.removeEventListener("project:save",e)},[C.forceSave]),r)?(0,s.jsx)("div",{className:"h-screen flex items-center justify-center bg-white dark:bg-gray-900",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"프로젝트를 불러오는 중..."})]})}):a?(0,s.jsxs)("div",{className:"h-screen flex items-center justify-center text-red-500",children:["오류: ",a]}):(0,s.jsxs)(c.z,{children:[(0,s.jsxs)("div",{className:p.container,children:[(0,s.jsx)(d.z,{title:C.title,onTitleChange:C.setTitle,onBack:V,sidebarCollapsed:w,onToggleSidebar:N,showRightSidebar:T,onToggleAISidebar:F,isFocusMode:v.isFocusMode,onToggleFocusMode:v.toggleFocusMode,onSave:C.forceSave,onShare:M,onDownload:L,onDelete:W}),(0,s.jsxs)("div",{className:p.main,children:[!w&&(0,s.jsx)(i.m,{currentView:j,onViewChange:U,structure:C.structure,characters:C.characters,stats:C.writerStats,collapsed:!1}),(0,s.jsxs)("div",{className:p.editorContainer,children:["write"===j&&(0,s.jsx)(A.L,{content:C.content,onChange:C.setContent,isFocusMode:v.isFocusMode}),"structure"===j&&(0,s.jsx)(f.l,{structure:C.structure,onStructureChange:C.setStructure}),"characters"===j&&(0,s.jsx)(g.E,{projectId:t,characters:C.characters,onCharactersChange:C.setCharacters}),"notes"===j&&(0,s.jsx)(x.d,{projectId:t,notes:C.notes||[],onNotesChange:C.setNotes})]}),(0,s.jsx)(l.H,{showRightSidebar:T,toggleRightSidebar:F,writerStats:C.writerStats,setWordGoal:C.setWordGoal,currentText:C.content,projectId:t})]})]}),(0,s.jsx)(n.S,{}),(0,s.jsx)(u.K,{isOpen:D,projectTitle:C.title,onConfirm:B,onCancel:()=>y(!1)}),(0,s.jsx)(h.G,{isOpen:S,projectTitle:C.title,projectId:t,onClose:()=>P(!1)})]})});class v extends o.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t}),E.V.error("PROJECT_ERROR_BOUNDARY","Client-side exception caught",{error:e.message,stack:e.stack,componentStack:t.componentStack}),console.error("\uD83D\uDEA8 ProjectErrorBoundary caught an error:",e),console.error("Error Info:",t),console.error("Component Stack:",t.componentStack)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:(0,s.jsx)("div",{className:"h-screen flex items-center justify-center bg-white dark:bg-gray-900",children:(0,s.jsxs)("div",{className:"max-w-md text-center p-6",children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDE35"}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"앗! 오류가 발생했습니다"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"클라이언트에서 예외가 발생했습니다. 페이지를 새로고침하거나 다시 시도해보세요."}),!1,(0,s.jsxs)("div",{className:"space-x-4",children:[(0,s.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"페이지 새로고침"}),(0,s.jsx)("button",{onClick:()=>window.history.back(),className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"뒤로 가기"})]})]})}):this.props.children}constructor(e){super(e),this.state={hasError:!1}}}function j(){let e=(0,a.useParams)(),t=Array.isArray(e.id)?e.id[0]:e.id;return t?(E.V.debug("PROJECT_PAGE","Loading project page",{projectId:t}),(0,s.jsx)(v,{children:(0,s.jsx)(C,{projectId:t})})):(E.V.error("PROJECT_PAGE","Missing project ID in route parameters"),(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"오류"}),(0,s.jsx)("p",{className:"text-slate-600",children:"프로젝트 ID가 없습니다."})]})}))}},1604:(e,t,r)=>{"use strict";r.d(t,{J0:()=>s.useState,Kr:()=>s.useMemo,hb:()=>s.useCallback,li:()=>s.useRef,vJ:()=>s.useEffect});var s=r(7620)},2063:(e,t,r)=>{"use strict";r.d(t,{B8:()=>A.A,Cy:()=>c.A,Hs:()=>f.A,MD:()=>u.A,Pk:()=>g.A,SE:()=>o.A,Vw:()=>n.A,X:()=>E.A,ZU:()=>x.A,_:()=>i.A,_B:()=>d.A,fV:()=>l.A,g5:()=>h.A,hc:()=>s.A,yQ:()=>a.A});var s=r(6907),o=r(7884),a=r(2794),c=r(5615),n=r(3848),i=r(2754),l=r(7065),d=r(8312),u=r(4311),h=r(1295),A=r(4616),f=r(8830),g=r(8134),x=r(3436),E=r(3206)},2122:(e,t,r)=>{"use strict";r.d(t,{FW:()=>c.A,Gy:()=>s.A,W7:()=>o.A,We:()=>i.A,X:()=>l.A,eM:()=>n.A,g5:()=>a.A});var s=r(6666),o=r(484),a=r(1295),c=r(2708),n=r(5419),i=r(6043),l=r(3206)},3010:(e,t,r)=>{"use strict";r.d(t,{AX:()=>n.A,Bx:()=>d.A,JG:()=>s.A,QR:()=>o.A,TB:()=>A.A,_H:()=>l.A,bd:()=>h.A,eM:()=>i.A,h1:()=>c.A,ni:()=>a.A,sU:()=>u.A});var s=r(985),o=r(2463),a=r(8789),c=r(2823),n=r(5059),i=r(5419),l=r(2918),d=r(8640),u=r(1717),h=r(5480),A=r(2825)},4862:(e,t,r)=>{Promise.resolve().then(r.bind(r,1324))},5168:(e,t,r)=>{"use strict";r.d(t,{X:()=>a.A,m:()=>o.A,o:()=>s.A});var s=r(5837),o=r(2432),a=r(3206)},5350:(e,t,r)=>{"use strict";r.d(t,{FW:()=>i.A,Hs:()=>n.A,T5:()=>a.A,Vn:()=>l.A,c_:()=>s.A,kr:()=>o.A,sU:()=>d.A,vE:()=>c.A,zW:()=>u.A});var s=r(3722),o=r(5980),a=r(7480),c=r(7327),n=r(8830),i=r(2708),l=r(414),d=r(1717),u=r(5677)},6238:(e,t,r)=>{"use strict";r.d(t,{FW:()=>l.A,Pt:()=>c.A,TB:()=>d.A,Vw:()=>i.A,Xh:()=>s.A,c_:()=>a.A,iU:()=>n.A,yQ:()=>o.A});var s=r(1424),o=r(2794),a=r(3722),c=r(6419),n=r(4376),i=r(3848),l=r(2708),d=r(2825)},6409:(e,t,r)=>{"use strict";r.d(t,{X:()=>o.A,h:()=>s.A});var s=r(6907),o=r(3206)},6543:(e,t,r)=>{"use strict";r.d(t,{FW:()=>i.A,Gy:()=>s.A,W7:()=>a.A,a4:()=>n.A,iU:()=>c.A,jl:()=>o.A,zW:()=>l.A});var s=r(6666),o=r(2608),a=r(484),c=r(4376),n=r(4038),i=r(2708),l=r(5677)},7099:(e,t,r)=>{"use strict";r.d(t,{J0:()=>s.useState,hb:()=>s.useCallback});var s=r(7620)},7378:(e,t,r)=>{"use strict";r.d(t,{B0:()=>o.A,Cy:()=>a.A,Gk:()=>h.A,J2:()=>i.A,N_:()=>l.A,Pk:()=>u.A,QR:()=>c.A,a4:()=>d.A,xf:()=>n.A,yN:()=>s.A,z2:()=>A.A});var s=r(6609),o=r(5448),a=r(5615),c=r(2463),n=r(1149),i=r(9276),l=r(9264),d=r(4038),u=r(8134),h=r(5935),A=r(1326)},8324:(e,t,r)=>{"use strict";r.d(t,{Jl:()=>s.A,QR:()=>o.A,X:()=>i.A,_H:()=>n.A,f5:()=>a.A,gE:()=>c.A});var s=r(8454),o=r(2463),a=r(7904),c=r(9641),n=r(2918),i=r(3206)},8371:(e,t,r)=>{"use strict";r.d(t,{FW:()=>o.A,W7:()=>s.A,X:()=>c.A,eM:()=>a.A});var s=r(484),o=r(2708),a=r(5419),c=r(3206)},9897:(e,t,r)=>{"use strict";r.d(t,{hb:()=>s.useCallback,li:()=>s.useRef,vJ:()=>s.useEffect});var s=r(7620)}}]);